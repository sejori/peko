"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["diffs"],{70499(a,b,c){var d,e,f,g,h,i=c(59753),j=c(3126);let k;(0,i.on)("click",".js-conversation-menu-button",(k=!0,async function(a){if(!1===k){let b=a.currentTarget,c=b.closest(".select-menu"),d=c.querySelector("details-menu");if(!d)return;d.innerHTML="";let e=`${d.getAttribute("src")}?instrument=1`,f=await fetch(e);f.ok&&(d.innerHTML=await f.text())}k=!1})),(0,i.on)("click",".js-conversations-menu-item",function(a){let b=a.currentTarget,c=b.closest(".js-conversations-details");c.hasAttribute("open")&&c.removeAttribute("open"),window.location.hash=b.hash,(0,j.kc)(document)}),(0,i.on)("click",".js-resolved-conversations",async function(a){var b;let c=a.currentTarget.querySelector(".dropdown-caret"),d=a.currentTarget.querySelector(".select-menu-header");""===(b=c).style.transform?b.style.transform="rotate(180deg)":b.style.transform="",d.classList.toggle("border-bottom-0")});var l=c(76932),m=c(81574),n=c(64463),o=c(33537);function p({currentTarget:a}){let b=a,c=b.hasAttribute("open"),d=b.closest(".js-file-header");d.classList.toggle("has-open-dropdown",c)}function q(){let a=Array.from(r()).filter(a=>a.checked);return a.map(a=>a.value)}function r(){return document.querySelectorAll(".js-diff-file-type-option")}function s(){let a=document.querySelector(".js-deleted-files-toggle");if(a instanceof HTMLInputElement)return a}function t(){return w()||y()||z()||u()||x()}function u(){return v().length>0}function v(){let a=document.querySelectorAll(".js-diff-owner-option"),b=Array.from(a).filter(a=>a.checked);return b.map(a=>a.value)}function w(){return q().length!==r().length}function x(){let a=document.querySelector(".js-manifests-option");return!!a&&a.checked}function y(){let a=s();return!!a&&!a.checked}function z(){let a=document.querySelector(".js-viewed-files-toggle");return!!a&&!a.checked}function A(){let a=new URLSearchParams(window.location.search);return a.has("w")}function B(a){let b=document.querySelector(".js-file-filter-text");b.classList.toggle("color-fg-accent",a)}function C(a){let b=document.querySelector(".js-reset-filters"),c=document.querySelector(".js-commits-filtered");null==b||c||(b.hidden=!a)}function D(){let a=w(),b=document.querySelector(".js-file-filter-select-all-container"),c=a?"data-select-all-markup":"data-all-selected-markup",d=b.getAttribute(c);b.textContent=d,b.classList.toggle("color-fg-muted",!a),b.classList.toggle("color-fg-accent",a)}function E(){let a=r(),b=y();for(let c of a)if(b){let d="0"===c.getAttribute("data-non-deleted-files-count");c.disabled=d}else c.disabled=!1}function F(){let a=document.querySelectorAll(".js-file-type-count");for(let b of a){let c=y()?"data-non-deleted-file-count-markup":"data-all-file-count-markup",d=b.getAttribute(c);d&&(b.textContent=d)}}(0,i.on)("details:toggled-group",".js-file.js-details-container",function(a){a.target===a.currentTarget&&function a(b){let c=document.querySelector(".js-file-filter");if(!c)return;let d=r();for(let e of d)e.checked=b;let f=s();f&&(f.checked=!b);let g=t();B(g),C(g),E(),D(),F(),(0,o.X)(g,A(),q(),u(),v(),x(),y(),z())}(a.detail.open)}),(0,i.on)("details:toggled",".js-file.js-details-container",function(a){if(a.target!==a.currentTarget)return;let b=a.currentTarget;b.getBoundingClientRect().top<0&&(0,j.zT)(b)}),(0,m.Z)(()=>{let a=window.location.hash.slice(1);if(!a)return;let b=document.getElementsByName(a)[0];if(!b)return;let c=b.nextElementSibling;c&&c.matches(".js-file.js-details-container")&&(c.classList.add("open"),c.classList.add("Details--on"))}),(0,n.N7)(".js-file-header-dropdown",{subscribe:a=>(0,l.RB)(a,"toggle",p)}),(0,i.on)("click",".js-jump-to-menu-item",function({currentTarget:a}){let b=a.getAttribute("href").substring(1),c=document.querySelector(`[data-anchor="${b}"]`);if(c){let d=c.closest(".js-file.js-details-container");d.hidden=!1}!function(){let a=document.querySelector(".js-file-filter-blankslate");if(!a)return;let b=document.querySelectorAll(".js-diff-progressive-loader");if(b.length>0){a.hidden=!0;return}let c=document.querySelectorAll(".js-file");if(0===c.length){a.hidden=!0;return}let d=Array.from(c).some(a=>!a.hidden);a.hidden=d}()});var G=c(78232),H=c(47851),I=c(69567),J=c(54650),K=c(98249),L=c(75662),M=c(65935);let N="```suggestion",O=RegExp(`${N}(?:.*)
`,"i"),P=RegExp("```(\n|$)");function Q(a,b){let c=a.slice(0,b).split("\n");return a.split("\n")[c.length-1]}function R(a){let b=/^(\s+)/.exec(a);return b&&b[0]||""}function S(a,b,c=0){let d=b.substring(c,b.length),e=a.exec(d);return e?e.index+c:-1}function T(a,b){let c=[],d=0,e=-1;for(;(e=S(O,a,d))> -1;){d=e+N.length;let f=S(P,a,d);if(-1===f)return!1;d=f+3,c.push([e,f])}return c.some(a=>b>a[0]&&b<a[1])}var U=c(254),V=c(22971);let W={addToBatchEnabled:".js-add-to-batch-enabled",unchangedSuggestion:".js-unchanged-suggestion",closedOrMergedPull:".js-closed-pull",viewingSubset:".js-viewing-subset-changes",leftBlob:".js-validation-on-left-blob",rightBlob:".js-validation-on-right-blob",outdatedComment:".js-outdated-comment",resolvedThread:".js-resolved-thread",pendingReview:".js-pending-review",isMultiLine:".js-is-multiline",inMergeQueue:".js-in-merge-queue"};function X(a,b){let c=document.querySelectorAll(".js-apply-suggestion-button"),d=a.querySelector(".js-disabled-apply-suggestion-button");for(let e of c){let f=d.cloneNode(!0);Z(f,b),e.closest("details").replaceWith(f)}}function Y(a){let b=document.querySelector(".js-batched-suggested-changes-container");for(let c of(b&&b.classList.add("d-none"),document.querySelectorAll(".js-apply-single-suggestion")))c.classList.remove("d-none"),c.disabled=!0,c.setAttribute("aria-label",a);for(let d of document.querySelectorAll(".js-batched-suggested-changes-add"))d.classList.remove("d-none"),d.disabled=!0,d.setAttribute("aria-label",a);for(let e of document.querySelectorAll(".js-batched-suggested-changes-remove"))e.classList.add("d-none");for(let f of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))f.classList.add("d-none");for(let g of document.querySelectorAll(".js-pending-batched-suggestion-label"))g.classList.add("d-none")}function Z(a,b){a.setAttribute("aria-label",b),a.classList.remove("d-none")}function $(a,b){let c=document.querySelector(".js-suggested-changes-inline-validation-template").cloneNode(!0);c.classList.remove("js-suggested-changes-inline-validation-template");let d=c.querySelector(".js-suggested-changes-inline-error-message");d.textContent=a.trim();let e=b.parentNode;e.insertBefore(c,b.nextSibling)}function _(a){let b=document.querySelector(".js-suggested-changes-subset-files");if(!b)return;let c=a.querySelectorAll(".js-suggested-change-toolbar-item"),d=W.viewingSubset;if(!d)return;let e=document.querySelector(d).textContent.trim();for(let f of c){f.setAttribute("aria-disabled","true");let g=f.getAttribute("aria-describedby"),h=document.getElementById(g);h.textContent=e}}function aa(){let a=document.querySelector(".js-batched-suggested-changes-container");a&&setTimeout(()=>(function(a){let b=a.closest(".js-review-state-classes"),c=b.querySelectorAll("[data-pending-batched-suggestion]").length;for(let d of document.querySelectorAll(".js-pending-batched-suggested-changes-count"))d.textContent=String(c);let e=document.querySelector(".js-reenable-add-to-batch").textContent;for(let f of document.querySelectorAll("[data-batched-suggestion-reenable-sibling]"))f.removeAttribute("data-batched-suggestion-reenable-sibling"),f.removeAttribute("disabled"),f.setAttribute("aria-label",e);if(c>0){a.hidden=!1;let g=a.querySelector(".js-batched-suggested-changes-toggle");for(let h of(g.classList.add("anim-pulse-in"),g.addEventListener("animationend",()=>g.classList.remove("anim-pulse-in"),{once:!0}),document.querySelectorAll(".js-apply-single-suggestion")))h.classList.add("d-none");for(let i of document.querySelectorAll(".js-batched-suggested-changes-add")){let j=i.closest(".js-suggested-change-form-container");"true"===j.getAttribute("data-pending-batched-suggestion")||"true"===j.getAttribute("data-comment-pending")||"true"===j.getAttribute("data-outdated-comment")?i.classList.add("d-none"):i.classList.remove("d-none"),"true"===i.getAttribute("data-batched-suggestion-disabled-by-sibling")&&(i.removeAttribute("data-batched-suggestion-disabled-by-sibling"),i.setAttribute("disabled","disabled"),i.setAttribute("aria-label",document.querySelector(".js-one-suggestion-per-line").textContent))}for(let k of document.querySelectorAll(".js-batched-suggested-changes-remove")){let l=k.closest(".js-suggested-change-form-container");"true"===l.getAttribute("data-pending-batched-suggestion")?k.classList.remove("d-none"):k.classList.add("d-none")}for(let m of document.querySelectorAll(".js-focus-commit-suggestions-form-button")){let n=m.closest(".js-suggested-change-form-container"),o="true"===n.getAttribute("data-comment-pending"),p="true"===n.getAttribute("data-outdated-comment"),q="true"===n.getAttribute("data-resolved-comment"),r=m.closest(".js-inline-comments-container"),s=r.querySelector('input[name="side"]'),t="left"===s.value;o||p||q||t?m.classList.add("d-none"):m.classList.remove("d-none")}for(let u of document.querySelectorAll(".js-pending-batched-suggestion-label")){let v=u.closest(".js-suggested-change-form-container");"true"===v.getAttribute("data-pending-batched-suggestion")?u.classList.remove("d-none"):u.classList.add("d-none")}}else{for(let w of(a.hidden=!0,document.querySelectorAll(".js-apply-single-suggestion")))w.classList.remove("d-none");for(let x of document.querySelectorAll(".js-batched-suggested-changes-add"))x.classList.remove("d-none");for(let y of document.querySelectorAll(".js-batched-suggested-changes-remove"))y.classList.add("d-none");for(let z of document.querySelectorAll(".js-focus-commit-suggestions-form-button"))z.classList.add("d-none");for(let A of document.querySelectorAll(".js-pending-batched-suggestion-label"))A.classList.add("d-none")}})(a))}function ab(a,b){let c=a.querySelector("input[name=commit_title]"),d=a.querySelector("textarea[name=commit_message]"),e=c.value.trim();""===e&&(e=c.defaultValue);let f=d.value.trim();""!==f&&(e=`${e}

${f}
`),c.disabled=!0,d.disabled=!0;let g=document.createElement("input");g.setAttribute("type","hidden"),g.setAttribute("name","message"),g.value=e,a.appendChild(g);let h=document.createElement("input");h.setAttribute("type","hidden"),h.setAttribute("name","changes"),h.value=JSON.stringify(b),a.appendChild(h)}(0,i.on)("click",".js-suggested-change-toolbar-item",function(a){let b=a.currentTarget;b instanceof HTMLButtonElement&&"false"===b.getAttribute("aria-disabled")&&function(a){let b=a.getAttribute("data-lines");if(null!=b){let c=a.closest(".js-suggested-changes-container"),d=c.querySelector(".js-comment-field");!function(a,b){var c;let d,e=(c=a,d=`${N}
`,d+=`${c}
`,d+="```"),f=b.selectionStart,g=b.value,h=S(/\n/,g,f),i=""===g.trim(),j=Q(g,f),k=""===j.trim(),l=4,m=g,n=0;if(i)n=(m=e).length-l;else if(-1===h)n=k?(m=g+e).length-l:(m=[g,e].join("\n")).length-l;else if(k){let o=R(j),p=f-o.length,q=g.substring(0,p),r=g.substring(h,g.length);n=(m=[q,e,r].join("")).length-r.length-l}else if(T(g,f)){let s=S(/```/,g,f)+3,t=g.substring(0,s),u=g.substring(s,g.length);n=(m=[t,"\n",e,u].join("")).length-u.length-l}else{let v=g.substring(0,h),w=g.substring(h,g.length);n=(m=[v,"\n",e,w].join("")).length-w.length-l}(0,J.Se)(b,m),b.focus(),b.setSelectionRange(n,n)}(b,d)}}(b)}),(0,i.on)("click",".js-refresh-after-suggestion",V.H5),(0,n.N7)(".js-inline-comments-container",{add(a){_(a)}}),(0,n.N7)(".js-preview-body .js-apply-changes",{add(a){let b=a.closest(".js-suggested-changes-container");if(!b)return a.remove();let c=document.querySelector(W.rightBlob).textContent,d=document.querySelector(W.leftBlob).textContent,e=a.closest(".js-suggested-changes-blob");if(""!==b.getAttribute("data-thread-side")){if("left"===b.getAttribute("data-thread-side"))return $(d,e),a.remove()}else{let f=a.closest(".js-inline-comment-form"),g=f.querySelector('input[name="side"]');if(!f||!g)return a.remove();if(f&&"left"===g.value)return $(d,e),a.remove()}let h=a.previousElementSibling,i=h.querySelector(".js-blob-code-deletion"),j=h.querySelectorAll(".js-blob-code-addition");if(!i||0===j.length)return;let k=i.textContent,l=Array.from(j).map(a=>a.textContent);if(k===l.join("\n"))return $(c,e),a.remove();a.remove()}}),(0,n.N7)(".js-comment-body .js-apply-changes",{add(a){let b=a.closest(".js-comment");if(!b)return a.remove();let c=b.querySelector(".js-suggested-changes-template");if(!(c instanceof HTMLTemplateElement))return a.remove();let d=c.content.cloneNode(!0),e=d.querySelector(".js-disabled-apply-suggestion-button"),f;try{f=d.querySelector(".js-batched-suggested-changes-add")}catch(g){if("QueryError"!==g.name)throw g}if(document.querySelectorAll(".js-suggested-changes-files-tab").length){let h=document.querySelector(W.addToBatchEnabled).textContent;f&&(f.removeAttribute("disabled"),f.setAttribute("aria-label",h))}let i=document.querySelector(".js-pull-header-details"),j=i&&"true"===i.getAttribute("data-pull-is-open"),k=a.closest(".js-resolvable-timeline-thread-container"),l="true"===c.getAttribute("data-comment-pending"),m="true"===c.getAttribute("data-in-merge-queue"),n=b.classList.contains("js-selection-contains-deletions");if(k&&"true"===k.getAttribute("data-resolved")){let o=document.querySelector(W.resolvedThread).textContent,p=d.querySelector("details");return p&&p.remove(),Z(e,o),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",o)),a.replaceWith(d)}if(!j){let q=document.querySelector(W.closedOrMergedPull).textContent;return Z(e,q),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",q)),a.replaceWith(d)}if(m){let r=document.querySelector(W.inMergeQueue),s="";r&&(s=r.textContent||"");let t=d.querySelector("details");return t&&t.remove(),Z(e,s),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",s)),a.replaceWith(d)}if(l){let u=document.querySelector(W.pendingReview).textContent;return d.querySelector("details").remove(),Z(e,u),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",u)),a.replaceWith(d)}if(n){let v=document.querySelector(W.leftBlob).textContent;return d.querySelector("details").remove(),Z(e,v),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",v)),a.replaceWith(d)}let w=document.querySelector(".js-suggested-changes-subset-files"),x="true"===c.getAttribute("data-outdated-comment");if(w||x){let y;return w?y=document.querySelector(W.viewingSubset).textContent:x&&(y=document.querySelector(W.outdatedComment).textContent),d.querySelector("details").remove(),Z(e,y),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",y)),a.replaceWith(d)}let z=d.querySelector(".js-single-suggested-change-form"),A=a.closest(".js-suggested-changes-blob");if(A){let B=A.querySelectorAll(".js-blob-code-deletion"),C=A.querySelectorAll(".js-blob-code-addition");if(!B)return;let D=Array.from(B).map(a=>a.textContent),E=Array.from(C).map(a=>a.textContent),F=D.length===E.length&&D.every((a,b)=>a===E[b]);if(F){let G=document.querySelector(W.unchangedSuggestion).textContent;d.querySelector("details").remove(),Z(e,G),f&&(f.setAttribute("disabled","disabled"),f.setAttribute("aria-label",G))}else for(let H of E){let I=document.createElement("input");I.setAttribute("type","hidden"),I.setAttribute("name","value[]"),I.value=H,z.appendChild(I)}}a.replaceWith(d)}}),(0,n.N7)(".js-pull-header-details",{add(a){let b="true"===a.getAttribute("data-pull-is-open"),c=document.querySelector(".js-suggested-changes-template");if(b||!(c instanceof HTMLTemplateElement))return;let d=c.content,e=document.querySelector(W.closedOrMergedPull).textContent;X(d,e),Y(e)}}),(0,n.N7)(".js-suggested-changes-subset-files",{add(){let a=document.querySelector(".js-suggested-changes-template");if(!(a instanceof HTMLTemplateElement))return;let b=a.content,c=document.querySelector(W.viewingSubset).textContent;X(b,c),Y(c)}}),(0,i.on)("click",".js-apply-suggestion-button",async function(a){let b=a.currentTarget.parentElement;if(b){let c=b.querySelector(".js-suggestion-commit-title");setTimeout(()=>c.focus(),1)}}),(0,i.on)("click",".js-dismiss-suggested-change-onboarding-notice",async function(a){let b=a.currentTarget.getAttribute("data-url"),c=a.currentTarget.parentElement.querySelector(".js-data-url-csrf"),d=new FormData;d.append("notice","suggested_changes_onboarding_prompt");let e=await fetch(b,{method:"POST",mode:"same-origin",body:d,headers:{"Scoped-CSRF-Token":c.value,"X-Requested-With":"XMLHttpRequest"}});if(e.ok){let f=document.querySelectorAll(".js-suggested-change-onboarding-notice");for(let g of f)g.remove()}}),(0,U.w4)("keypress",".js-comment-field",function(a){if("Enter"===a.key){let b=a.target;(function(a){let b=a.selectionStart;if(!T(a.value,b))return!1;let c=a.value,d=Q(c,b);if(null===d)return!1;let e=R(d),f=`
${e}`,g=c.substr(0,b)+f+c.substr(b);(0,J.Se)(a,g);let h=b+f.length;return a.setSelectionRange(h,h),!0})(b)&&a.preventDefault()}}),(0,U.w4)("keypress",".js-suggestion-commit-message",function(a){let b=a.currentTarget;"Enter"===a.key&&b.setAttribute("rows","3")}),(0,i.on)("click",".js-batched-suggested-changes-add",function(a){let b=a.target,c=b.closest(".js-suggested-change-form-container");if("true"===c.getAttribute("data-comment-pending")||"true"===c.getAttribute("data-outdated-comment")||"true"===b.getAttribute("data-batched-suggestion-disabled-by-sibling"))return;c.setAttribute("data-pending-batched-suggestion","true");let d=b.closest(".js-inline-comments-container");for(let e of d.querySelectorAll(".js-batched-suggested-changes-add"))e.setAttribute("data-batched-suggestion-disabled-by-sibling","true");b.removeAttribute("data-batched-suggestion-disabled-by-sibling"),aa()}),(0,i.on)("click",".js-batched-suggested-changes-remove",function(a){let b=a.currentTarget.closest(".js-suggested-change-form-container");b.removeAttribute("data-pending-batched-suggestion");let c=a.currentTarget.closest(".js-inline-comments-container");for(let d of c.querySelectorAll(".js-batched-suggested-changes-add"))d.setAttribute("data-batched-suggestion-reenable-sibling","true");aa()}),(0,i.on)("click",".js-focus-commit-suggestions-form-button",function(a){a.preventDefault(),window.location.href="#clear-commit-suggestions",window.location.href="#commit-suggestions"}),(0,i.on)("click",".js-dismiss-batched-suggested-changes-onboarding-notice",async function(a){let b=a.currentTarget.getAttribute("data-url"),c=a.currentTarget.parentElement.querySelector(".js-data-url-csrf"),d=new FormData;d.append("notice","batched_suggested_changes_onboarding_prompt");let e=await fetch(b,{method:"POST",mode:"same-origin",body:d,headers:{"Scoped-CSRF-Token":c.value,"X-Requested-With":"XMLHttpRequest"}});if(e.ok)for(let f of document.querySelectorAll(".js-batched-suggested-change-onboarding-notice"))f.remove()}),(0,i.on)("click",".js-single-suggested-change-form .js-suggested-changes-submit",function(a){let b=a.currentTarget,c=b.closest(".js-single-suggested-change-form"),d=Array.from(c.querySelectorAll('input[name="value[]"]')).map(a=>a.value),e=[{commentId:c.querySelector("input[name=comment_id]").value,path:c.querySelector("input[name=path]").value,suggestion:d}];ab(c,e)}),(0,M.AC)(".js-single-suggested-change-form",async function(a,b){let c=a.closest(".js-suggested-change-form-container"),d=a.closest("details"),e=c.querySelector(".js-suggestion-applied"),f=a.closest(".js-suggested-changes-contents"),g=f.querySelector(".js-error-message-placeholder");try{await b.json(),e.classList.remove("d-none");let h=c.querySelector(".js-batched-suggested-changes-add");h.classList.add("d-none"),d.remove(),(0,V.H5)()}catch(i){if("QueryError"!==i.name){let j=i.response.json&&i.response.json.error,k=g.querySelector(".js-error-message");g.hidden=!1,k.textContent=j,c.prepend(g);let l=a.closest(".js-suggested-change-form-container"),m=l.querySelector(".js-batched-suggested-changes-add");m.classList.add("d-none"),d.remove()}}}),(0,i.on)("click",".js-suggestion-batch-submit",function(a){let b=a.currentTarget.closest(".js-batched-suggested-changes-form"),c=[];for(let d of document.querySelectorAll("[data-pending-batched-suggestion]")){let e=d.querySelector(".js-single-suggested-change-form"),f=Array.from(e.querySelectorAll('input[name="value[]"]')).map(a=>a.value);c.push({commentId:e.querySelector("input[name=comment_id]").value,path:e.querySelector("input[name=path]").value,suggestion:f})}ab(b,c)}),(0,M.AC)(".js-batched-suggested-changes-form",async function(a,b){try{await b.json();let c=a.closest(".js-batched-suggested-changes-container");c.hidden=!0,(0,V.H5)()}catch(d){let e=d.response.json&&d.response.json.error,f=a.closest(".js-batched-suggested-changes-container"),g=f.querySelector(".js-error-message-container"),h=g.querySelector(".js-error-message");h.textContent=e,g.hidden=!1}}),(0,n.N7)(".js-files-tab-stale",{add(){let a=document.querySelector(".js-batched-suggested-changes-container");a&&setTimeout(()=>{a.hidden=!0})}});let ac=0;function ad(a,b){let c=a.nextElementSibling;return c&&c.matches(b)?c:null}function ae(a,b){let c=Array.from(a.querySelectorAll(".review-comment-form-container")).pop();if(c)return c.closest("div.js-line-comments");{let d=an("js-inline-comments-single-container-template",b).querySelector("div.js-line-comments");return a.appendChild(d),d}}function af(a){let b=a.querySelector(".js-toggle-file-notes");b instanceof HTMLInputElement&&(0,J.Se)(b,!0)}function ag(){for(let a of document.querySelectorAll(".file .js-inline-comments-container")){let b=a.querySelectorAll(".js-comments-holder > *"),c=b.length>0,d=null!=a.querySelector("[data-resolved='true']"),e=a.querySelector(".js-inline-comment-form-container"),f=!!e&&e.classList.contains("open");c||d||f||a.remove()}}async function ah(a){let b=a.querySelector(".js-suggestion-button-placeholder");if(!b)return;let c=b.getAttribute("data-src-base");if(!c)return;let d=new URL(c,window.location.origin),e=b.closest(".js-inline-comment-form")||b.closest(".js-comment-update");if(!(e instanceof HTMLFormElement))return;let f=function(a,b){let c=new URLSearchParams(a.search.slice(1)),d=b.elements.namedItem("in_reply_to")||b.elements.namedItem("comment_id"),e=b.querySelector("textarea");if(c.append("textarea_id",e.id),d instanceof HTMLInputElement&&d.value)return c.append("comment_id",d.value),c;let f=b.elements.namedItem("path"),g=b.elements.namedItem("start_side"),h=b.elements.namedItem("start_line"),i=b.elements.namedItem("side"),j=b.elements.namedItem("line"),k=b.elements.namedItem("start_commit_oid"),l=b.elements.namedItem("end_commit_oid"),m=b.elements.namedItem("base_commit_oid"),n=b.elements.namedItem("subject_type");return f instanceof HTMLInputElement&&g instanceof HTMLInputElement&&h instanceof HTMLInputElement&&i instanceof HTMLInputElement&&j instanceof HTMLInputElement&&k instanceof HTMLInputElement&&l instanceof HTMLInputElement&&m instanceof HTMLInputElement&&n instanceof HTMLInputElement?(c.append("path",f.value),c.append("start_side",g.value),c.append("start_line",h.value),c.append("end_side",i.value),c.append("end_line",j.value),c.append("start_commit_oid",k.value),c.append("end_commit_oid",l.value),c.append("base_commit_oid",m.value),c.append("subject_type",n.value),c):null}(d,e);if(!f)return;d.search=f.toString();let g=await (0,K.a)(document,d.toString());b.innerHTML="",b.appendChild(g)}function ai(a,b,c){let d=a.querySelector(`.js-line-comments.${b}`);if(d)return d;let e=an("js-inline-comments-split-form-container-template",c).firstElementChild;e.classList.add(b);let f=a.querySelectorAll(`.${b}`),g=f[f.length-1];for(let h of(g.after(e),f))h.remove();return e}function aj(a){let b=ad(a,".js-inline-comments-container");if(b)return b;{let c="js-inline-comments-split-container-template",d=document.getElementById(c);if(!d)throw Error(`Could not find element with id ${c}`);if(!(d instanceof HTMLTemplateElement))throw Error(`Found element with id ${c} - but was not a Template`);return b=new I.R(d,{}).firstElementChild,a.after(b),b}}function ak(a,b,c,d){if(a.classList.remove("color-bg-success","color-bg-danger"),d){a.textContent=b;return}if("right"===c){a.classList.add("color-fg-success"),a.textContent=`+${b}`;return}if("left"===c){a.classList.add("color-fg-danger"),a.textContent=`-${b}`;return}a.textContent=String(b)}(0,i.on)("click",".js-add-file-comment",function(a){let b=a.currentTarget,c=b.closest(".file");af(c);let d=function a(b){let c=b.closest(".file-header"),d=ad(c,".diff-table");if(d instanceof Element){let e=d.querySelector(".js-inline-comments-container");if(e instanceof Element)return e}}(b)||function a(b){let c=b.closest(".file-header"),d=document.createElement("table");d.className="diff-table";let e=an("js-inline-comments-single-container-template",b).firstElementChild;return d.appendChild(e),c.after(d),e}(b),e=ae(d.querySelector("td"),b),f=e.querySelector(".js-inline-comment-form");f instanceof HTMLFormElement&&am(f,b),(0,G.j)(e)}),(0,i.on)("click",".js-add-single-line-comment",function(a){let b=a.currentTarget,c=b.closest(".file");af(c);let d=function a(b){let c=b.closest("tr"),d=ad(c,".js-inline-comments-container");if(d instanceof Element)return d}(b)||function a(b){let c=b.closest("tr"),d=an("js-inline-comments-single-container-template",b).firstElementChild;return c.after(d),d}(b),e=ae(d.querySelector("td"),b),f=e.querySelector(".js-inline-comment-form");f instanceof HTMLFormElement&&am(f,b),(0,G.j)(e)}),(0,i.on)("click",".js-add-split-line-comment",function(a){let b=a.currentTarget,c=b.closest(".file");af(c);let d=b.closest("tr"),e="addition"===b.getAttribute("data-type")?"js-addition":"js-deletion",f=aj(d),g=ai(f,e,b),h=ae(g,b),i=h.querySelector(".js-inline-comment-form");i instanceof HTMLFormElement&&am(i,b),(0,G.j)(h)}),(0,M.AC)(".js-inline-comment-form",async function(a,b){(function a(b){let c=b.querySelector(".js-comment-form-error");c&&(c.hidden=!0,c.textContent=null)})(a);let c;try{c=await b.json()}catch(d){if(d.response){let e;try{e=d.response.json}catch{}if(e){(function a(b,c){let d=b.querySelector(".js-comment-form-error"),e;e=c.errors?Array.isArray(c.errors)?c.errors.join(", "):c.errors:"There was an error posting your comment.",d.textContent=e,d.style.display="block",d.hidden=!1,d.classList.remove("d-none")})(a,e);return}}throw d}let f=c.json,g=f.inline_comment,h=a.closest(".js-line-comments");g&&h.querySelector(".js-comments-holder").append((0,L.r)(document,g));let i=f.inline_comment_thread;i&&h.replaceWith((0,L.r)(document,i)),(0,G.w)(a)}),document.addEventListener("session:resume",function(a){let b=a.detail;(function(a){let[b,c]=a.match(/^new_inline_comment_(?:discussion|diff)_(?:[\w-]+)_(\d+)_(\d+)$/)||[];if(!b)return;let d=document.querySelector(`.js-inline-comment-form input[name='in_reply_to'][value='${c}']`);if(!d)return;let e=d.closest(".js-line-comments");e&&(0,G.j)(e)})(b.targetId),function(a){let[b,c]=a.match(/^new_inline_comment_diff_(?:[\w-]+)_(\d+)$/)||[];if(!b)return;let d=document.querySelector(`.js-add-line-comment[data-anchor='${b}'][data-position='${c}']`);d&&d.click()}(b.targetId)}),(0,n.N7)(".js-comment",{remove:ag}),(0,i.on)("inlinecomment:focus",".js-inline-comment-form-container",function(a){let b=a.target.querySelector(".js-suggested-changes-container");b&&ah(b)}),(0,n.N7)(".js-suggested-changes-container.is-comment-editing",a=>{ah(a)}),document.addEventListener("inlinecomment:collapse",()=>{ag()});let al={R:"right",L:"left"};function am(a,b){for(let c of["type","path","position","line","side","original-line"]){let d=a.elements.namedItem(c);if(d instanceof HTMLInputElement){let e=b.getAttribute(`data-${c}`)||"";d.value=e}}let f=a.elements.namedItem("subject_type");if(f instanceof HTMLInputElement){let g=b.getAttribute("data-subject-type")||"";f.value=g}let h=a.getElementsByClassName("js-expanded-diff-placeholder-value")?.[0];if(h instanceof HTMLInputElement){let i=b.getAttribute("data-expanded-diff")||"";h.value=i}!function(a,b){let c=(0,H.vu)();if(!c||c.end.is(c.start))return;if(!(0,H.Oz)(b,c)){(0,H.MO)();return}let{start:{lineNumber:d},end:{lineNumber:e}}=c,{start:{side:f},end:{side:g}}=c,h=Number(b.getAttribute("data-line")),i=b.getAttribute("data-side");if(h!==e|| !c.end.isContext()&&i!==al[g]){(0,H.MO)();return}let j=al[f],k=a.elements.namedItem("start_line"),l=a.elements.namedItem("start_side"),m=a.elements.namedItem("line"),n=a.elements.namedItem("side"),o=a.elements.namedItem("preview_start_side"),p=a.elements.namedItem("preview_side");if(k instanceof HTMLInputElement&&l instanceof HTMLInputElement&&m instanceof HTMLInputElement&&n instanceof HTMLInputElement&&o instanceof HTMLInputElement&&p instanceof HTMLInputElement){k.value=String(d),l.value=j,l.value=o.value=l.value,p.value=n.value;let q=k.value;f=l.value;let r=m.value;g=n.value;let s=a.closest(".js-inline-comment-form-container");if(q&&r){let t=s.querySelector(".js-multi-line-preview"),u=t.querySelector(".js-multi-line-preview-start"),v=t.querySelector(".js-multi-line-preview-end"),w=c.start.isContext(),x=c.end.isContext();ak(u,q,f,w),ak(v,r,g,x),t.hidden=!1,s.classList.add("is-multiline")}else s.querySelector(".js-multi-line-preview").hidden=!0,s.classList.remove("is-multiline");_(s)}}(a,b)}function an(a,b){let c=document.getElementById(a);if(!c)throw Error(`Could not find element with id ${a}`);if(!(c instanceof HTMLTemplateElement))throw Error(`Found element with id ${a} - but was not a Template`);return new I.R(c,{anchor:b.getAttribute("data-anchor")||"",position:b.getAttribute("data-position")||"",subject_type:b.getAttribute("data-subject-type")||"",sequence:ac++})}var ao=c(70763),ap=c(87098),aq=c(52191);function ar(a){let b=as();if(!b)return;at(a,b);let c=au(a,b);c&&((0,j.zT)(c),ax(c))}function as(){return window.location.hash.slice(1)}function at(a,b){let c;(c=b.match(/^diff-.+[LR]\d+-[LR]\d+/)?(0,ap.Q)(a.ownerDocument,b.substring(0,b.indexOf("-",5))):(0,ap.Q)(a.ownerDocument,b))&&a.contains(c)?((0,ao.O4)(c),(0,j.zT)(c)):function(a,b){let c=a.querySelectorAll(".js-comment-container");for(let d of c){let e=d.getAttribute("data-hidden-comment-ids");if(e){let f=e.split(","),g=b.match(/\d+/g)?.[0];if(g&&f.includes(g)){(0,aq.$)(d);break}}}}(a,b)}function au(a,b){let c=av(a,b);return c||aw(a,b)}function av(a,b){let c=/^(diff-[0-9a-f]{32})(?:[L|R]\d+)?$/.exec(b);if(!c)return;let d=c[1],e=a.querySelector(`a[name='${d}']`);if(!e)return;let f=e.nextElementSibling;if(!f||f.querySelector(".js-diff-load-container"))return f}function aw(a,b){let c=/^(?:r|commitcomment-)(\d+)$/.exec(b);if(!c)return;let d=c[1],e=a.querySelector(`#diff-with-comment-${d}`);if(!e)return;let f=e.closest(".js-file");return f}function ax(a){let b=a.querySelector(".js-diff-entry-loader"),c=a.querySelector(".js-diff-placeholder"),d=a.querySelector("button.js-diff-load"),e=a.querySelector(".js-button-text");c.setAttribute("fill","url('#animated-diff-gradient')"),e.textContent=d.getAttribute("data-disable-with")||"",d.disabled=!0;let f=new URL(b.getAttribute("data-fragment-url")||"",window.location.origin);return b.src=f.toString(),b.data}(0,n.N7)(".js-diff-progressive-container",function(a){ar(a);let b=a.querySelector(".js-diff-progressive-loader");b&&b.addEventListener("load",function(){ar(a)})}),(0,n.N7)(".js-diff-load-container",function(a){let b=a.querySelector(".js-diff-entry-loader");b&&b.addEventListener("load",function(){let b=a.closest(".js-file");b.classList.remove("hide-file-notes-toggle");let c=as();c&&at(a,c)})}),(0,i.on)("click",".js-diff-load",function(a){if(a.target.classList.contains("js-ignore-this"))return;let b=a.currentTarget.closest(".js-diff-load-container");ax(b)});var ay=c(9302);(0,i.on)("click",".js-rendered, .js-source",function(a){let b=a.currentTarget;if(b.classList.contains("selected")){a.preventDefault();return}(function a(b){let c=b.closest(".js-file-header"),d=b.classList.contains("js-rendered"),e=b.classList.contains("js-source"),f=c.getAttribute("data-short-path"),g=c.getAttribute("data-anchor"),h=new URL(window.location.href,window.location.origin),i=new URLSearchParams(h.search.slice(1));h.hash=g,d?i.set("short_path",f):e&&i.delete("short_path"),h.search=i.toString(),(0,ay.lO)(null,"",h.toString())})(b),function a(b){for(let c of document.querySelectorAll(".js-rendered, .js-source"))c.classList.remove("selected"),c.removeAttribute("aria-current");b.classList.add("selected"),b.setAttribute("aria-current","true")}(b)}),(0,M.AC)(".js-prose-diff-toggle-form",async function(a,b){let c=a.closest(".js-details-container"),d=c.querySelector(".js-file-content"),e=await b.html();for(;d.lastChild;)d.removeChild(d.lastChild);d.append(e.html),c.classList.toggle("display-rich-diff")}),(0,i.on)("click",".js-toc-retry",function(a){if(!(a.target instanceof Element))return;let b=a.target.closest(".select-menu"),c=b.querySelector("include-fragment"),d=c.getAttribute("src");c.setAttribute("src",""),c.setAttribute("src",d)});var az=c(86824);function aA(a,b,c){let d=Array.from(a.querySelectorAll('[role="menuitem"]')),e=d.indexOf(b),f=d.indexOf(c);if(-1===e)throw Error("Couldn't find startIndex in container");if(-1===f)throw Error("Couldn't find endItem in container");for(let g of(aC(a),d[f].classList.add("is-last-in-range"),e>f&&([e,f]=[f,e]),d.slice(e,f+1)))g.classList.add("is-range-selected")}async function aB(a,b){function c(c){aA(a,b,c.target.closest('[role="menuitem"]'))}aA(a,b,b),a.addEventListener("mouseover",c),await new Promise(a=>window.addEventListener("keyup",a,{once:!0})),a.removeEventListener("mouseover",c),aC(a)}function aC(a){for(let b of a.querySelectorAll('[role="menuitem"]'))b.classList.remove("is-range-selected","is-last-in-range")}(0,n.N7)(".js-diffbar-range-menu .js-diffbar-range-list",{subscribe:function(a){let b=a.closest("details-menu"),c=!1;function d(a){(c=a.shiftKey)&&a.preventDefault()}function e(b){if(!c)return;b.preventDefault();let d=b.detail.relatedTarget;if(d.classList.contains("is-range-selected")){b.stopPropagation();let e=a.querySelectorAll(".is-range-selected"),f=e[0],g=e[e.length-1],h=a.getAttribute("data-range-url"),i=f.getAttribute("data-parent-commit"),j=g.getAttribute("data-commit"),k=i&&j?`${i}..${j}`:j,l=h.replace("$range",k);(0,az.T)(l)}else b.stopImmediatePropagation(),aB(a,d)}return a.addEventListener("click",d,{capture:!0}),b.addEventListener("details-menu-select",e),{unsubscribe(){a.removeEventListener("click",d,{capture:!0}),b.removeEventListener("details-menu-select",e)}}}}),(0,i.on)("toggle",".js-diffbar-range-menu",function(a){let b=a.currentTarget;if(!b.hasAttribute("open"))return;let c=b.querySelector(".in-range");c&&c.focus()},{capture:!0});var aD=c(97629);(0,i.on)("click",".js-compare-tab",function(a){for(let b of document.querySelectorAll(".js-compare-tab.selected"))b.classList.remove("selected");for(let c of(a.currentTarget.classList.add("selected"),document.querySelectorAll("#commits_bucket, #files_bucket, #commit_comments_bucket")))c.classList.add("d-none");let d=a.currentTarget,e=d.hash;document.querySelector(e).classList.remove("d-none"),a.preventDefault()}),(0,m.Z)(function({target:a}){if(!(a instanceof HTMLElement))return;let b=a.closest("#commits_bucket, #files_bucket, #commit_comments_bucket");b&&b instanceof HTMLElement&&!(0,aD.Z)(b)&&document.querySelector(`.js-compare-tab[href="#${b.id}"]`).click()}),(0,i.on)("click",".js-toggle-range-editor-cross-repo",function(){document.querySelector(".js-range-editor").classList.toggle("is-cross-repo")}),(0,n.N7)(".js-compare-pr.open",{add(){document.body.classList.add("is-pr-composer-expanded")},remove(){document.body.classList.remove("is-pr-composer-expanded")}}),(0,i.on)("change",".js-collab-checkbox",function({currentTarget:a}){let b=a.form;for(let c of b.querySelectorAll(".errored"))c.classList.remove("errored");let d=a.closest(".js-collab-option"),e=d.querySelector(".js-status-indicator");e.classList.remove("status-indicator-success","status-indicator-failed"),e.classList.add("status-indicator-loading")}),(0,M.AC)(".js-collab-form",async function(a,b){try{await b.text()}catch(c){for(let d of a.querySelectorAll(".status-indicator-loading")){d.classList.remove("status-indicator-loading"),d.classList.add("status-indicator-failed");let e=d.closest(".js-collab-option");e.classList.add("errored");let f=e.querySelector(".js-collab-checkbox");f.checked=!f.checked}for(let g of a.querySelectorAll(".status-indicator-success"))g.classList.remove("status-indicator-success");return}for(let h of a.querySelectorAll(".errored"))h.classList.remove("errored");for(let i of a.querySelectorAll(".status-indicator-loading"))i.classList.remove("status-indicator-loading"),i.classList.add("status-indicator-success")});var aE=c(76006),aF=c(3447);function aG(a,b,c){if(!b.has(a))throw TypeError("attempted to "+c+" private field on non-instance");return b.get(a)}function aH(a,b){var c,d,e=aG(a,b,"get");return c=a,(d=e).get?d.get.call(c):d.value}function aI(a,b,c){!function(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}(a,b),b.set(a,c)}function aJ(a,b,c){var d=aG(a,b,"set");return!function(a,b,c){if(b.set)b.set.call(a,c);else{if(!b.writable)throw TypeError("attempted to set read only private field");b.value=c}}(a,d,c),c}var aK=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};let aL=(d=new WeakMap,e=new WeakMap,f=new WeakMap,g=new WeakMap,h=class DiffLayoutElement extends HTMLElement{connectedCallback(){if(!this.sidebarContainer)return;aJ(this,g,new MutationObserver(this.handleNotificationShelfMutation)),aH(this,g).observe(document.body,{subtree:!0,childList:!0});let{signal:a}=aJ(this,f,new AbortController);window.addEventListener("scroll",this.handleSidebarScroll,{signal:a}),window.addEventListener("resize",()=>this.handleSidebarResize(),{signal:a}),this.handleSidebarScroll()}disconnectedCallback(){this.sidebarContainer&&(aH(this,g).disconnect(),aH(this,f)?.abort(),null!=aH(this,d)&&cancelAnimationFrame(aH(this,d)),null!=aH(this,e)&&cancelAnimationFrame(aH(this,e)))}toggleSidebar(a){if(this.layoutContainer.classList.toggle("hx_Layout--sidebar-hidden"),this.sidebarHidden=!this.sidebarHidden,!this.fileTree)return;let b=a.detail.toggleButton;b&&(this.fileTree.instrumentToggleFileTree(b),this.fileTreePathFilter&&"show-file-tree-button"===b.id&&this.fileTreePathFilter.focus())}handleOpenFilesListHotkeyEvent(){if(this.shouldOpenTocMenu()){this.tocMenuButton.click();return}this.fileTree&&(this.showFileTreeButton&&this.sidebarHidden?this.showFileTreeButton.click():this.fileTreePathFilter&&!this.sidebarHidden&&this.fileTreePathFilter.focus())}shouldOpenTocMenu(){return!!(this.tocMenu&&!this.tocMenu.hasAttribute("open")&&"none"!==window.getComputedStyle(this.tocMenu).display)}handleNotificationShelfMutation(a){let b=document.firstElementChild;if(b.classList.contains("js-skip-scroll-target-into-view"))for(let c of a){for(let d of c.addedNodes)if(d instanceof HTMLElement&&d.classList.contains("js-notification-top-shelf")){b.classList.add("has-notification-top-shelf");break}for(let e of c.removedNodes)if(e instanceof HTMLElement&&e.classList.contains("js-notification-top-shelf")){b.classList.remove("has-notification-top-shelf");break}}}handleSidebarResize(){aJ(this,e,requestAnimationFrame(this.updateSidebarHeight))}constructor(...a){super(...a),aI(this,d,{writable:!0,value:null}),aI(this,e,{writable:!0,value:null}),aI(this,f,{writable:!0,value:void 0}),aI(this,g,{writable:!0,value:void 0}),this.handleSidebarScroll=()=>{aJ(this,d,requestAnimationFrame(this.updateSidebarHeight))},this.updateSidebarHeight=()=>{if(!this.sidebarContainer)return;let a=document.documentElement.clientHeight,b=this.diffToolbar.getBoundingClientRect(),c=this.mainContainer.getBoundingClientRect(),d=a>=c.bottom,e=0===b.top,f;f=d?c.bottom-parseInt(this.sidebarContainer.style.top):e?a-b.height:a-parseInt(this.sidebarContainer.style.top),this.sidebarContainer.style.height=`${f}px`},this.sidebarHidden=!1}},h.attrPrefix="",h);aK([aE.Lj],aL.prototype,"sidebarHidden",void 0),aK([aE.fA],aL.prototype,"layoutContainer",void 0),aK([aE.fA],aL.prototype,"diffToolbar",void 0),aK([aE.fA],aL.prototype,"tocMenu",void 0),aK([aE.fA],aL.prototype,"tocMenuButton",void 0),aK([aE.fA],aL.prototype,"mainContainer",void 0),aK([aE.fA],aL.prototype,"sidebarContainer",void 0),aK([aE.fA],aL.prototype,"fileTree",void 0),aK([aE.fA],aL.prototype,"showFileTreeButton",void 0),aK([aE.fA],aL.prototype,"fileTreePathFilter",void 0),aK([(0,aF.D)(100)],aL.prototype,"handleSidebarResize",null),aL=aK([aE.Ih],aL),(0,i.on)("click",".js-split-diff-view",function(){let a=document.querySelector(".js-unified-diff-view-box"),b=document.querySelector(".js-split-diff-view-box"),c=document.querySelector(".js-split-diff-view-option"),d=document.querySelector(".js-unified-diff-view-option");b.classList.add("color-border-accent-emphasis"),b.classList.remove("color-border-default"),a.classList.remove("color-border-accent-emphasis"),a.classList.add("color-border-default"),d.checked=!1,c.checked=!0}),(0,i.on)("click",".js-unified-diff-view",function(){let a=document.querySelector(".js-unified-diff-view-box"),b=document.querySelector(".js-split-diff-view-box"),c=document.querySelector(".js-split-diff-view-option"),d=document.querySelector(".js-unified-diff-view-option");b.classList.remove("color-border-accent-emphasis"),b.classList.add("color-border-default"),a.classList.add("color-border-accent-emphasis"),a.classList.remove("color-border-default"),d.checked=!0,c.checked=!1});var aM=c(11793),aN=c(29764);let aO=class InstrumentFilesElement extends HTMLElement{connectedCallback(){document.addEventListener("keydown",this.instrumentCtrlF)}disconnectedCallback(){document.removeEventListener("keydown",this.instrumentCtrlF)}constructor(...a){super(...a),this.instrumentCtrlF=a=>{let b=(0,aM.EL)(a);["Control+f","Meta+f"].includes(b)&&(0,aN.sz)(this)}}};aO=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}([aE.Ih],aO);var aP=c(27034),aQ=c(76177);(0,i.on)("details:toggled",".js-pull-merging",function({currentTarget:a}){let b=Array.from(a.querySelectorAll(".js-merge-pull-request")),c=b.some(aD.Z);for(let d of b)d.classList.toggle("is-dirty",c)}),(0,i.on)("click",".js-merge-box-try-again",async function({currentTarget:a}){let b=a.getAttribute("data-form-target");if(!["js-cleanup-branch-form","js-merge-branch-form","js-queue-branch-form","js-update-branch-form"].includes(b))return;let c=a.closest(".js-pull-merging").getElementsByClassName(b)[0];(0,i.f)(c,"submit")}),document.addEventListener("session:resume",function(a){let b=document.getElementById(a.detail.targetId);if(b){let c=b.closest(".js-merge-pull-request");if(c){let d=c.closest(".js-details-container");d&&d.classList.add("open")}}}),(0,i.on)("change",".js-admin-merge-override",function({currentTarget:a}){let b=a.closest(".js-merge-message-container"),c=a.checked,d=b.querySelector(".js-merge-box"),e=b.querySelector(".js-auto-merge-box"),f=b.querySelector(".js-merge-form"),g=b.querySelector(".js-auto-merge-form"),h=b.querySelector(".js-queue-branch-form"),i=b.querySelectorAll(".merge-box-button");for(let j of(d&&(d.hidden=!c),e&&(e.hidden=c),f&&(f.hidden=!c),g&&(g.hidden=c),h&&(h.hidden=c),i))j.disabled=!c}),(0,i.on)("details-menu-selected",".js-update-branch-method-menu",function(a){let b=a.detail.relatedTarget,c=b.closest(".js-merge-pr");c.classList.toggle("is-updating-via-merge","merge"===b.value),c.classList.toggle("is-updating-via-rebase","rebase"===b.value);let d=c.querySelector(".js-update-branch-type");d&&(d.value=b.value)},{capture:!0}),(0,i.on)("submit",".js-update-branch-form",function({currentTarget:a}){let b=a.closest(".js-merge-pr"),c=b?.querySelector(".btn-group-update-merge");c&&(c.disabled=!0);let d=b?.querySelector(".btn-group-update-rebase");d&&(d.disabled=!0);let e=b?.querySelector(".js-update-method-menu-button");e&&(e.classList.add("disabled","user-select-none"),e.setAttribute("aria-disabled","true"));let f=b?.querySelector(".js-update-branch-method-menu");f&&f?.parentNode?.removeChild(f)}),(0,i.on)("details-menu-selected",".js-merge-method-menu",function(a){let b=a.detail.relatedTarget,c=b.closest(".js-merge-pr"),d=c.querySelector(".js-merge-pull-request"),e=c.querySelector(".js-merge-method-menu-button"),f=e.getAttribute("data-merge-button-class");e.classList.toggle("btn-danger",b.hasAttribute("data-dangerous-action")),f&&e.classList.toggle(f,!b.hasAttribute("data-dangerous-action"));let g=c.querySelectorAll(".js-merge-title"),h=c.querySelectorAll(".js-merge-message");for(let i of g)i.defaultValue===i.value&&(i.defaultValue=i.value=b.getAttribute("data-input-title-value"));for(let j of h)j.defaultValue===j.value&&(j.defaultValue=j.value=b.getAttribute("data-input-message-value"));c.classList.toggle("is-merging","merge"===b.value),c.classList.toggle("is-squashing","squash"===b.value),c.classList.toggle("is-rebasing","rebase"===b.value),c.classList.toggle("is-merging-group","group"===b.value),c.classList.toggle("is-merging-solo","solo"===b.value),c.classList.toggle("is-merging-jump","jump"===b.value);let k=d.classList.contains("js-admin-override-merge")&&"merge"===b.value||d.classList.contains("js-admin-override-squash")&&"squash"===b.value||d.classList.contains("js-admin-override-rebase")&&"rebase"===b.value,l=c.querySelector(".js-merge-type");l&&(l.value=b.value);let m=c.querySelectorAll(".js-merge-pull-request .js-merge-commit-button,.js-confirm-auto-merge-button");for(let n of m)b.value===n.value?(n.type="submit",n.classList.contains("js-confirm-auto-merge-button")&&(0,aQ.j)(n)):n.type="button";d.classList.toggle("color-fg-danger",k);let o=c.closest(".js-pull-merging"),p=new URL(o.getAttribute("data-url"),window.location.origin),q=new URLSearchParams(p.search);q.set("merge_type",b.value),p.search=q.toString(),o.setAttribute("data-url",p.toString())},{capture:!0}),(0,i.on)("details:toggled",".js-merge-pr",function(a){let b=a.currentTarget,c=b.querySelector(".js-merge-message");c&&(0,i.f)(c,"change")}),(0,n.N7)(".branch-action-item.js-details-container.open",{add(a){for(let b of a.querySelectorAll(".js-merge-review-section"))b.setAttribute("open","")},remove(a){for(let b of a.querySelectorAll(".js-merge-review-section"))b.removeAttribute("open")}}),(0,i.on)("toggle",".js-details-container .js-merge-review-section",function({currentTarget:a}){let b=a.closest(".js-details-container"),c=b.querySelectorAll(".js-merge-review-section").length,d=b.querySelectorAll(".js-merge-review-section[open]").length;0===d?(0,ao.Qp)(b,{force:!1}):d===c&&(0,ao.Qp)(b,{force:!0})},{capture:!0}),(0,n.N7)("poll-include-fragment[data-to-be-polled]",{constructor:aP.Z,add(a){function b(){a.src=a.getAttribute("data-to-be-polled"),a.removeAttribute("data-to-be-polled")}document.hidden?document.addEventListener("visibilitychange",b,{once:!0}):b()}}),(0,i.on)("submit",".js-remove-from-queue-form",async a=>{let b=a.currentTarget;a.preventDefault();let c=await fetch(b.action,{method:b.method,body:new FormData(b),headers:{Accept:"application/json"}});(!c||!c.ok)&&(window.onbeforeunload=()=>{window.scrollTo({top:0})},window.location.reload())});var aR=c(96776);let aS=!1;function aT(){let a=document.querySelectorAll(".pull-request-ref-restore");for(let b=0;b<a.length;b++)a[b].classList.toggle("last",b===a.length-1)}function aU(){let a=null!=document.querySelector("#js-pull-restorable"),b=document.querySelector(".js-pull-discussion-timeline");b&&b.classList.toggle("is-pull-restorable",a)}document.addEventListener("keydown",function(a){"Alt"===a.key&&(aS=!0)}),document.addEventListener("keyup",function(a){"Alt"===a.key&&(aS=!1)}),(0,i.on)("click",".js-toggle-outdated-comments",function(a){if(!(a instanceof MouseEvent&&a.altKey||aS)||!(a.currentTarget instanceof HTMLElement))return;let b=a.currentTarget,c=b.closest("details");function d(){let a=c.hasAttribute("open");for(let d of document.querySelectorAll(".js-toggle-outdated-comments"))if(d!==b){let e=d.closest("details");e.toggleAttribute("open",a)}}setTimeout(()=>{(0,aR.uQ)(b,d)})}),(0,n.N7)(".pull-request-ref-restore",{add:aT,remove:aT}),(0,n.N7)("#js-pull-restorable",{add:aU,remove:aU});var aV=c(54679);function aW(a){let b=document.querySelector(".js-reviews-container");b&&setTimeout(()=>(function(a,b){let c=a.closest(".js-review-state-classes"),d=document.querySelector(".js-review-changes");for(let e of(c.classList.toggle("is-review-pending",b>0),document.querySelectorAll(".js-pending-review-comment-count")))e.textContent=String(b);for(let f of document.querySelectorAll(".js-pending-comment-count-type"))f instanceof HTMLElement&&(f.textContent=f.getAttribute(1===b?"data-singular-string":"data-plural-string"));if(b>0){d.textContent=d.getAttribute("data-pending-message")||"";let g=a.querySelector(".js-reviews-toggle");g.classList.add("anim-pulse-in"),g.addEventListener("animationend",()=>g.classList.remove("anim-pulse-in"),{once:!0})}else d.textContent=d.getAttribute("data-message")||""})(b,a))}function aX(a){return a.getAttribute("ratio").split("/")}function aY(a){if(a){let[b,c]=aX(a),d=parseInt(b)/parseInt(c),e=a.querySelector(".js-review-progress"),f=a.querySelector(".js-review-count");e instanceof HTMLElement&&f&&(e.style.width=`${100*d}%`,f.textContent=`${b} / ${c}`)}}(0,M.AC)(".js-inline-comment-form",async function(a,b){let c=await b.text();aW(c.json.pendingReviewCommentsCount)}),(0,M.AC)(".js-pending-review-comment .js-comment-delete",async function(a,b){let c=await b.text();aW(c.json.pendingReviewCommentsCount)}),(0,M.AC)(".js-resolvable-timeline-thread-form",async function(a,b){try{let c=await b.html(),d=a.closest(".js-resolvable-timeline-thread-container");d.replaceWith(c.html)}catch(e){(0,aV.v)()}}),(0,M.AC)(".js-toggle-user-reviewed-file-form",async function(a,b){let c=a.closest(".js-details-container"),d=!!c.querySelector(".js-reviewed-file"),e=c.classList.contains("open"),f=c.querySelector(".js-file-header"),g=!!f&&60===f.getBoundingClientRect().top;(!d&&e||d&&!e)&&((0,ao.Qp)(c),g&&(0,j.zT)(c));let h=a.querySelector(".js-reviewed-toggle");d?(h.classList.remove("color-bg-accent","color-border-accent"),h.classList.add("color-fg-muted","color-border-default")):(h.classList.remove("color-fg-muted","color-border-default"),h.classList.add("color-bg-accent","color-border-accent"));let i=h.querySelector(".js-reviewed-checkbox");i.disabled=!0;let k=document.querySelector("progress-bar");k instanceof aZ&&(d?k.decrement():k.increment());let l=document.getElementById(`file-tree-item-${c.id}`);l&&l.toggleAttribute("data-file-user-viewed");let m=await b.html(),n=a.closest(".js-replace-file-header-review");n&&(n.replaceWith(m.html),c.toggleAttribute("data-file-user-viewed"))});let aZ=class ProgressBarElement extends HTMLElement{static get observedAttributes(){return["ratio"]}attributeChangedCallback(a){"ratio"===a&&aY(this)}connectedCallback(){aY(this)}increment(){let[a,b]=aX(this),c=Math.min(parseInt(a)+1,parseInt(b));this.setAttribute("ratio",`${c}/${b}`)}decrement(){let[a,b]=aX(this),c=Math.min(parseInt(a)-1,parseInt(b));this.setAttribute("ratio",`${c}/${b}`)}};window.customElements.get("progress-bar")||(window.ProgressBarElement=aZ,window.customElements.define("progress-bar",aZ));var a$=c(80721),a_=c(31167);document.addEventListener(a_.QE.SUCCESS,function(){for(let a of document.querySelectorAll(".js-pull-refresh-on-pjax"))(0,V.x0)(a)}),(0,n.N7)(".js-updating-pull-request-commits-count",{add(a){let b=a.textContent,c=document.querySelectorAll(".js-updateable-pull-request-commits-count");for(let d of c)d.textContent=b}}),(async()=>{if(await a$.x,window.performance&&window.performance.navigation&&window.performance.navigation.type===window.performance.navigation.TYPE_RELOAD){let a=document.getElementById("js-report-pull-request-refresh");a&&(0,aN.Fk)(a)}})();var a0=c(2825),a1=c(37574);function a2(a){(0,ao.O4)(a),(0,j.zT)(a)}async function a3(a,b){let{anchor:c,side:d,line:e,lastLine:f,hashFragment:g,partialHashFragment:h}=a,i=(0,ap.Q)(document,c);if(!i)return;let j=i.nextElementSibling;if(!j)return;let k=a7(j,d,e,f);if(!k.length){let l=(0,ap.Q)(document,g);if(l){a2(l);return}let m=j.querySelector(".js-diff-load-container");if(!m)return;try{await function(a){let b=a.querySelector(".js-diff-entry-loader"),c=a.querySelector(".js-diff-placeholder"),d=a.querySelector("button.js-diff-load"),e=a.querySelector(".js-button-text");c.setAttribute("fill","url('#animated-diff-gradient')"),e.textContent=d.getAttribute("data-disable-with")||"",d.disabled=!0;let f=new URL(b.getAttribute("data-fragment-url")||"",window.location.origin);return b.src=f.toString(),b.data}(m);let n=(0,ap.Q)(document,g);n instanceof HTMLElement&&a2(n)}catch(o){a2(j)}return}await a4(k,h);let p=1,q=(0,ap.Q)(document,g),r=a7(j,d,e,f);r.length?a3(a,b):q?a2(q):b<p&&a3(a,b+1)}function a4(a,b){return Promise.all(a.map(a=>a5(a,b)))}async function a5(a,b){let c;if(b){let d="R"===b.slice(-1)?"data-right-range":"data-left-range",e=a.getAttribute(d)||"",f=parseInt(e.split("-")[0],10);c=b+f}else c=a.hash.slice(1);let g=a.getAttribute("data-url"),h=new URL(g,window.location.origin),j=new URLSearchParams(h.search.slice(1));j.append("anchor",c),h.search=j.toString(),""!==window.location.hash&&window.history.replaceState(null,"","#");let k=await (0,K.a)(document,h.toString()),l=a.closest(".js-file");if(!l)return;let m=a.closest(".js-expandable-line"),n=a6(m,".file-diff-line");n?(0,aR.uQ)(n,()=>{m.replaceWith(k)}):m.replaceWith(k),(0,i.f)(l,"expander:expanded"),a8(l)}function a6(a,b){let c=a.nextElementSibling;return c instanceof HTMLElement&&c.matches(b)?c:null}function a7(a,b,c,d){let e=parseInt(c,10),f=parseInt(d||"",10);return Array.from(a.querySelectorAll(".js-expand")).filter(a=>{let c="R"===b?"data-right-range":"data-left-range",d=(a.getAttribute(c)||"").split("-"),g=parseInt(d[0],10),h=parseInt(d[1],10);return!!(g<=e)&&!!(e<=h)|| !!(e<=g)&&!!(h<=f)|| !!(g<=f)&&!!(f<=h)})}function a8(a){let b=a.querySelector(".js-expand-full-wrapper");if(!b)return;let c=Array.from(a.querySelectorAll(".js-expand"));0===c.length&&b.parentElement.removeChild(b)}async function a9(a,b){let c=await self.fetch(b,{headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!c.ok)throw Error(`Request to blob_expand failed with status code ${c.status}`);(0,a0.t)((0,a0.P)(a),c,!0);let d=await c.json();return d.map(b=>({...b,content:(0,L.r)(a,b.content)}))}function ba(a){let b=Array.from(a.querySelectorAll(".js-expand")),c=b.map((a,b)=>(function(a,b){let c=new URL(a.getAttribute("data-url"),window.location.origin),d=c.searchParams;return{position:b.toString(),left:{start:d.get("last_left"),end:d.get("left"),size:d.get("left_hunk_size")},right:{start:d.get("last_right"),end:d.get("right"),size:d.get("right_hunk_size")}}})(a,b)),d=!1,e=[];for(let f=0;f<c.length;f++){if(d){d=!1;continue}let g=c[f],h=c[f+1];d=h&&g.left.start===h.left.start&&g.left.end===h.left.end&&g.right.start===h.right.start&&g.right.end===h.right.end,e.push(g)}return e}(0,m.Z)(function(){let a=function a(b){if(!b)return;let c=(0,a1.s)(b);if(!c)return;let d=c[1],e=c[2],f=c[3],g=c[5],h=d+e+f,i=d+e;return{anchor:d,side:e,line:f,lastLine:g,hashFragment:h,partialHashFragment:i}}(window.location.hash);if(a){if((0,ap.Q)(document,a.hashFragment)&&!a.lastLine)return;a3(a,0)}}),(0,i.on)("click",".js-expand",function(a){a.preventDefault(),a5(a.currentTarget)}),(0,i.on)("click",".js-expand-full",async a=>{a.preventDefault();let b=a.currentTarget,c=b.closest(".file"),d=b.getAttribute("data-url"),e=ba(c);if(0===e.length)return;let f=new URL(d,window.location.origin),g=new URLSearchParams(f.search.slice(1));for(let h of e)g.append("ranges[]last_left",h.left.start),g.append("ranges[]left",h.left.end),g.append("ranges[]left_hunk_size",h.left.size),g.append("ranges[]last_right",h.right.start),g.append("ranges[]right",h.right.end),g.append("ranges[]right_hunk_size",h.right.size),g.append("ranges[]position",h.position);f.search=g.toString();let i=await a9(document,f.toString()),j=[...c.querySelectorAll(".js-expand")];for(let{content:k,position:l}of i){let m=parseInt(l,10),n=j[m];if(!n)return;let o=n.closest(".js-expandable-line"),p=a6(o,".file-diff-line");p?(0,aR.uQ)(p,()=>{o.after(k)}):o.after(k),o.setAttribute("hidden","true")}b.setAttribute("hidden","true");let q=c.querySelector(".js-collapse-diff");q&&q.removeAttribute("hidden"),c.classList.add("open"),c.classList.add("Details--on")}),(0,i.on)("click",".js-collapse-diff",a=>{let b=a.currentTarget,c=b.closest(".file"),d=[...c.querySelectorAll('.blob-expanded[data-expanded-full="true"]')];for(let e of d)e.parentElement.removeChild(e);let f=[...c.querySelectorAll(".js-expandable-line")];for(let g of f)g.removeAttribute("hidden");b.setAttribute("hidden","true");let h=c.querySelector(".js-expand-full");h&&h.removeAttribute("hidden")});class DiffTableSideProtection{range(){let a;return this.selection?.rangeCount>0&&(a=this.selection.getRangeAt(0)),a}canBeSideProtected(){try{return!!(this.hasSelectedText()&&this.confinedTable())}catch(a){return!1}}isSideProtected(){try{return!!this.confinedTable()?.getAttribute("data-lock-side-selection")}catch(a){return!1}}hasSelectedText(){let a=this.range();return!!a&&a.toString().length>0}clearSelectedText(){this.selection.removeAllRanges()}confinedTable(){let a=this.range()?.commonAncestorContainer?.parentElement;if(a?.matches(".diff-table"))return a;if(a?.matches(".js-file-content")){let b=a?.querySelector("table.diff-table");return b}{let c=a?.closest("table.diff-table");return c}}unprotectedSide(){let a;return(this.anchorNode instanceof HTMLTableCellElement?this.anchorNode.closest("td[data-split-side]"):this.anchorNode?.parentElement?.closest("td[data-split-side]"))?.getAttribute("data-split-side")}protectedSide(){return"left"===this.unprotectedSide()?"right":"left"}applySideProtection(){if(this.unprotectedSide()){let a=this.confinedTable(),b=this.unprotectedSide();a&&b&&a.setAttribute("data-lock-side-selection",b)}}clearSideProtection(){let a=document.querySelectorAll("table[data-lock-side-selection]");for(let b of a){let c=b;c.removeAttribute("data-lock-side-selection")}}filteredTableRows(){let a=[];for(let b=0;b<this.selection.rangeCount;b++){let c=this.selection.getRangeAt(b),d=c.cloneContents();if(d.querySelectorAll("td").length){let e=`td[data-split-side=${this.protectedSide()}], td.js-linkable-line-number, td.empty-cell`,f=d.querySelectorAll(e);for(let g of f)g.parentNode&&g.parentNode.removeChild(g);a.push(...d.children)}else{let h=document.createElement("TR"),i=document.createElement("TD");i.append(...d.childNodes),h.append(i),a.push(h)}}return a}contentToString(){let a=[],b=document.createElement("table");b.classList.add("invisible"),b.append(...this.filteredTableRows()),this.confinedTable()?.append(b);let c=b.children;for(let d=0;d<c.length;d++){let e=c[d],f=e.innerText;f&&("\n"===f?a.push(""):a.push(f))}return b.remove(),a.join("\n")}constructor(a){this.selection=a,this.anchorNode=a.anchorNode}}function bb(a){return Math.floor(a/2)}function bc(a,b){let c=a.parentElement;c&&(!function(a){let b=a.querySelector(".js-comment-button-placeholder");if(b?.parentElement){let c=document.querySelector(".js-comment-button-template");if(!c)throw Error("missing js-comment-button-template template element!");let d=b.dataset;if(!d)throw Error("placeholder element has no dataset");d.originalLine=a.querySelector(".blob-code-inner")?.textContent||"";let e=new I.R(c,d);if(b.parentElement.replaceChild(e,b),d.expandedDiff){let f=a.querySelector(".js-add-line-comment");f&&f.setAttribute("data-expanded-diff",d.expandedDiff)}}}(c),bd(c,a,b))}function bd(a,b,c){let d=a.children,e;if(4===d.length)for(let f=0,g=d.length;f<g;f++){let h=d[f];h===b&&(e=bb(f))}for(let i=0,j=d.length;i<j;i++){let k=d[i];(null==e||bb(i)===e)&&k.classList.toggle("is-hovered",c)}}function be(a){let b=document.getSelection();if(b){let c=new DiffTableSideProtection(b);c.isSideProtected()&&(a.clipboardData?.setData("text/plain",c.contentToString()),a.preventDefault())}}function bf(a){let b=document.getSelection(),c=2===a.button;if(b&&!c){let d=new DiffTableSideProtection(b);d.isSideProtected()&&(d.clearSelectedText(),d.clearSideProtection())}}function bg(){let a=document.getSelection();if(a){let b=new DiffTableSideProtection(a);b.canBeSideProtected()?b.applySideProtection():b.clearSideProtection()}}function bh(){let a=document.querySelector("meta[name=diff-view]"),b=a&&a instanceof HTMLMetaElement?a.content:"",c=document.querySelector(".js-file-diff-split"),d=!!("split"===b&&c||document.querySelector(".wants-full-width-container"));document.body.classList.toggle("full-width",d)}function bi(a){let b=a.some(a=>a.checked);for(let c of a)(0,J.Se)(c,!b)}(0,n.N7)(".diff-table",function(a){let b=null;function c(){b&&bc(b,!1),b=null}function d(a){b&&bc(b,!1),a.target instanceof HTMLElement&&(b=a.target.closest("td.blob-code"))&&bc(b,!0)}return{add:function(){a.addEventListener("mouseenter",c),a.addEventListener("mouseleave",c),a.addEventListener("mouseover",d)},remove:function(){a.removeEventListener("mouseenter",c),a.removeEventListener("mouseleave",c),a.removeEventListener("mouseover",d)}}}),(0,n.N7)(".js-diff-container",function(){return{add:function(){document.addEventListener("copy",be),document.addEventListener("mousedown",bf),document.addEventListener("selectionchange",bg)},remove:function(){document.removeEventListener("copy",be),document.removeEventListener("mousedown",bf),document.removeEventListener("selectionchange",bg)}}}),c(99874),(0,n.N7)("meta[name=diff-view]",{add:bh,remove:bh}),(0,n.N7)(".js-file-diff-split",{add:bh,remove:bh}),(0,n.N7)(".js-compare-tab.selected",{add:bh,remove:bh}),(0,n.N7)(".wants-full-width-container",{add:bh,remove:bh}),(0,i.on)("change",".js-toggle-file-notes",function(a){let b=a.currentTarget;b.closest(".file").classList.toggle("show-inline-notes",b.checked)}),(0,i.on)("click",".js-toggle-all-file-notes",function(a){let b=Array.from(document.querySelectorAll(".js-toggle-file-notes"));bi(b),a.preventDefault()}),(0,i.on)("click",".js-toggle-all-file-annotations",function(a){let b=Array.from(document.querySelectorAll(".js-toggle-file-check-annotations"));bi(b),a.preventDefault()}),(0,n.N7)(".js-inline-comments-container",function(a){let b,c=a.closest(".file");if(c){let d=b=function(){let a=null!=c.querySelector(".js-inline-comments-container");c.classList.toggle("has-inline-notes",a)};return{add:d,remove:b}}}),(0,i.on)("change",".js-toggle-file-check-annotations",function(a){let b=a.currentTarget,c=b.closest(".file").querySelectorAll(".js-inline-annotations");for(let d of c)d instanceof HTMLElement&&(d.hidden=!b.checked)});var bj=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};let bk=class DiffFileFilterElement extends HTMLElement{connectedCallback(){this.filterState={hideDeletedFiles:!1,hideViewedFiles:!1,showManifestFilesOnly:!1,selectedOwners:[],showCodeownersFiles:!1,selectedFileTypes:[],fileTypeFilterActive:!1,filtersActive:!1}}applyFilter(a){this.filterState=a.detail,this.showResetFilters(),this.filterFiles(),this.filterTreeFiles(),this.hideEmptyDirectories(),this.showBlankslateIfEmpty()}clearFilters(a){a.preventDefault(),this.fileFilter.clearFilters()}filterFiles(){for(let a of this.diffEntries){let b=a.closest(".js-file.js-details-container");b.hidden=!this.shouldShowFile(a)}}filterTreeFiles(){for(let a of this.treeEntries){let b=this.shouldShowFile(a);a.hidden=!b,a.toggleAttribute("data-skip-substring-filter",!b)}}hideEmptyDirectories(){this.treeRoot&&this.hideEmptyDirectory(this.treeRoot)}hideEmptyDirectory(a){let b="root"===a.getAttribute("data-tree-entry-type"),c="directory"===a.getAttribute("data-tree-entry-type");if(b||c){let d=a.querySelectorAll(b?":scope > .js-tree-node":":scope > ul > .js-tree-node"),e=0;for(let f of d)e+=this.hideEmptyDirectory(f);return 0===e?(a.hidden=!0,0):(a.hidden=!1,1)}return a.hidden?0:1}async refilterAfterAsyncLoad(){await Promise.resolve(),this.refilterLoadedFiles(),this.showBlankslateIfEmpty()}refilterLoadedFiles(){this.filterState.filtersActive&&this.filterFiles()}shouldShowFile(a){let b=!0,c=a.getAttribute("data-file-type");if(c&&(b=this.filterState.selectedFileTypes.includes(c)),this.filterState.hideViewedFiles&&b){let d=a.hasAttribute("data-file-user-viewed");d&&(b=!1)}if(this.filterState.showCodeownersFiles&&b){let e=(a.getAttribute("data-codeowners")||"").split(",");b=e.filter(a=>this.filterState.selectedOwners.includes(a)).length>0}if(this.filterState.hideDeletedFiles&&b){let f="true"===a.getAttribute("data-file-deleted");f&&(b=!1)}if(this.filterState.showManifestFilesOnly&&b){let g=a.hasAttribute("data-file-manifest");g||(b=!1)}return b}showResetFilters(){this.resetFilters&&(this.resetFilters.hidden=!this.filterState.filtersActive)}showBlankslateIfEmpty(){if(!this.blankslate)return;if(this.progressiveLoaders.length>0||0===this.diffEntries.length){this.blankslate.hidden=!0;return}let a=Array.from(this.diffEntries).some(a=>!a.hidden);this.blankslate.hidden=a}};bj([aE.fA],bk.prototype,"blankslate",void 0),bj([aE.fA],bk.prototype,"resetFilters",void 0),bj([aE.GO],bk.prototype,"diffEntries",void 0),bj([aE.GO],bk.prototype,"progressiveLoaders",void 0),bj([aE.GO],bk.prototype,"treeEntries",void 0),bj([aE.fA],bk.prototype,"treeRoot",void 0),bj([aE.fA],bk.prototype,"fileFilter",void 0),bj([(0,aF.D)(20)],bk.prototype,"hideEmptyDirectories",null),bk=bj([aE.Ih],bk);var bl=c(19146);let bm=class InputDemuxBaseChangeContext{onItemSelected(a){if(!(a.currentTarget instanceof HTMLButtonElement))return;let b=a.currentTarget.querySelector(".js-ref-name").textContent,c=document.querySelector(".js-new-base-branch");c.value=btoa(unescape(encodeURIComponent(b||"")));let d=document.querySelector(".js-change-base-template").content.cloneNode(!0);d instanceof DocumentFragment&&(0,bl.W)({content:d})}},bn=class InputDemuxContextWrapperElement extends HTMLElement{connectedCallback(){let a=this.getAttribute("data-context-type"),b={baseChange:new bm};this.context=b[a]}onItemSelected(a){this.context.onItemSelected(a)}};bn=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g}([aE.Ih],bn),c(55843),c(82368),c(58541),c(57088)},52191(a,b,c){c.d(b,{"$":()=>k,G:()=>j});var d=c(76932),e=c(64463),f=c(59753);function g(a,b){let c=a.currentTarget;if(c instanceof Element){for(let d of c.querySelectorAll("[data-show-on-error]"))d instanceof HTMLElement&&(d.hidden=!b);for(let e of c.querySelectorAll("[data-hide-on-error]"))e instanceof HTMLElement&&(e.hidden=b)}}function h(a){g(a,!1)}function i(a){g(a,!0)}function j({currentTarget:a}){a instanceof Element&&k(a)}function k(a){let b=a.closest("details");b&&l(b)}function l(a){let b=a.getAttribute("data-deferred-details-content-url");if(b){a.removeAttribute("data-deferred-details-content-url");let c=a.querySelector("include-fragment, poll-include-fragment");c&&(c.src=b)}}(0,e.N7)("include-fragment, poll-include-fragment",{subscribe:a=>(0,d.qC)((0,d.RB)(a,"error",i),(0,d.RB)(a,"loadstart",h))}),(0,f.on)("click","include-fragment button[data-retry-button]",({currentTarget:a})=>{let b=a.closest("include-fragment"),c=b.src;b.src="",b.src=c})},78232(a,b,c){c.d(b,{j:()=>g,w:()=>h});var d=c(59753),e=c(64611),f=c(254);function g(a){let b=a.querySelector(".js-inline-comment-form-container");b.classList.add("open"),b.querySelector(".js-write-tab")?.click(),b.querySelector(".js-comment-field").focus(),(0,d.f)(b,"inlinecomment:focus")}function h(a){a.reset();let b=a.closest(".js-inline-comment-form-container");b.classList.remove("open");let c=b.querySelector(".js-multi-line-preview");c&&(c.hidden=!0),(0,d.f)(b,"inlinecomment:collapse")}(0,d.on)("click",".js-toggle-inline-comment-form",function(a){let b=a.currentTarget.closest(".js-line-comments");g(b)}),(0,d.on)("quote-selection",".js-line-comments",function(a){g(a.currentTarget),a.stopPropagation()}),(0,f.w4)("keydown",".js-inline-comment-form-container form .js-comment-field",function(a){let b=a.target;if(!b.classList.contains("js-navigation-enable")&&"Escape"===a.key&&0===b.value.length){let c=b.closest("form");h(c),a.preventDefault()}}),(0,d.on)("click",".js-hide-inline-comment-form",function(a){let b=a.currentTarget.closest("form");!(0,e.T)(b)||confirm(a.target.getAttribute("data-confirm-cancel-text"))?h(b):a.preventDefault()})},19146(a,b,c){c.d(b,{W:()=>e});var d=c(59753);async function e(a){let b=document.querySelector("#site-details-dialog"),c=b.content.cloneNode(!0),e=c.querySelector("details"),f=e.querySelector("details-dialog"),g=e.querySelector(".js-details-dialog-spinner");a.detailsClass&&e.classList.add(...a.detailsClass.split(" ")),a.dialogClass&&f.classList.add(...a.dialogClass.split(" ")),a.label?f.setAttribute("aria-label",a.label):a.labelledBy&&f.setAttribute("aria-labelledby",a.labelledBy),document.body.append(c);try{let h=await a.content;g.remove(),f.prepend(h)}catch(i){g.remove();let j=document.createElement("span");j.textContent=a.errorMessage||"Couldn't load the content",j.classList.add("my-6"),j.classList.add("mx-4"),f.prepend(j)}return e.addEventListener("toggle",()=>{e.hasAttribute("open")||((0,d.f)(f,"dialog:remove"),e.remove())}),f}},33537(a,b,c){c.d(b,{X:()=>e});var d=c(9302);function e(a,b,c,e,f,g,h,i){let j=document.querySelector(".js-file-filter"),k=new URL(window.location.href,window.location.origin);if(!a&&!e){if(b||g)return;return k.search="",(0,d.lO)((0,d.y0)(),"",k.toString())}let l=j.querySelector(".js-file-filter-form"),m=new FormData(l),n=c.filter(a=>!m.getAll("file-filters[]").includes(a)),o=f.filter(a=>!m.getAll("owned-by[]").includes(a));for(let p of n)m.append("file-filters[]",p);for(let q of o)m.append("owned-by[]",q);let r=new URLSearchParams(m);r.has("file-filters[]")&&""!==r.toString()||r.set("file-filters[]",""),b&&r.set("w","1"),g&&r.set("manifests","true"),h&&r.set("show-deleted-files","false"),i&&r.set("show-viewed-files","false"),r.delete("authenticity_token"),k.search=r.toString(),(0,d.lO)((0,d.y0)(),"",k.toString())}},98249(a,b,c){c.d(b,{D:()=>g,a:()=>f});var d=c(2825),e=c(75662);async function f(a,b,c){let f=new Request(b,c);f.headers.append("X-Requested-With","XMLHttpRequest");let g=await self.fetch(f);if(g.status<200||g.status>=300)throw Error(`HTTP ${g.status}${g.statusText||""}`);return(0,d.t)((0,d.P)(a),g),(0,e.r)(a,await g.text())}function g(a,b,c=1e3,d=[200]){return async function c(e){let f=new Request(a,b);f.headers.append("X-Requested-With","XMLHttpRequest");let g=await self.fetch(f);if(202===g.status)return await new Promise(a=>setTimeout(a,e)),c(1.5*e);if(d.includes(g.status))return g;if(g.status<200||g.status>=300)throw Error(`HTTP ${g.status}${g.statusText||""}`);throw Error(`Unexpected ${g.status} response status from poll endpoint`)}(c)}},2825(a,b,c){function d(a){let b=[...a.querySelectorAll("meta[name=html-safe-nonce]")].map(a=>a.content);if(b.length<1)throw Error("could not find html-safe-nonce on document");return b}c.d(b,{P:()=>d,t:()=>f});let e=class ResponseError extends Error{constructor(a,b){super(`${a} for HTTP ${b.status}`),this.response=b}};function f(a,b,c=!1){let d=b.headers.get("content-type")||"";if(!c&&!d.startsWith("text/html"))throw new e(`expected response with text/html, but was ${d}`,b);if(c&&!(d.startsWith("text/html")||d.startsWith("application/json")))throw new e(`expected response with text/html or application/json, but was ${d}`,b);let f=b.headers.get("x-html-safe");if(f){if(!a.includes(f))throw new e("response X-HTML-Safe nonce did not match",b)}else throw new e("missing X-HTML-Safe nonce",b)}},55843(a,b,c){var d=c(76006),e=function(a,b,c,d){var e,f=arguments.length,g=f<3?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)g=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)(e=a[h])&&(g=(f<3?e(g):f>3?e(b,c,g):e(b,c))||g);return f>3&&g&&Object.defineProperty(b,c,g),g};let f=class InputDemuxElement extends HTMLElement{connectedCallback(){this.control&&(this.storedInput=Array(this.control.children.length).fill("")),this.addEventListener("input",this.relayInput.bind(this)),this.addEventListener("keydown",this.relayKeydown.bind(this));let a=this.closest("details");a&&a.addEventListener("toggle",()=>{a.open&&this.source.focus()})}relayKeydown(a){if((this.isControlTab(a.target)||a.target===this.source)&&("ArrowDown"===a.key||"Tab"===a.key))a.preventDefault(),a.stopPropagation(),this.routeCustomEvent(new CustomEvent("focus-list"));else if("Escape"===a.key){let b=this.closest("details");b&&b.removeAttribute("open")}}isControlTab(a){return!!a&&!!this.control&&Array.from(this.control.children).includes(a)}relayInput(a){if(!a.target)return;let b=a.target,c=b.value;this.routeCustomEvent(new CustomEvent("input-entered",{detail:c}))}routeCustomEvent(a){let b=this.sinks[this.selectedIndex];b.dispatchEvent(a)}get selectedIndex(){if(!this.control)return 0;let a=this.control.querySelector('[aria-selected="true"]');return a?Array.from(this.control.children).indexOf(a):0}storeInput(){this.storedInput[this.selectedIndex]=this.source.value}updateInput(a){this.source.value=this.storedInput[this.selectedIndex];let b=a.detail.relatedTarget.getAttribute("data-filter-placeholder");this.source.placeholder=b,this.source.setAttribute("aria-label",b),this.notifySelected()}notifySelected(){let a=this.sinks[this.selectedIndex],b=new CustomEvent("tab-selected");a.dispatchEvent(b)}};e([d.fA],f.prototype,"source",void 0),e([d.GO],f.prototype,"sinks",void 0),e([d.fA],f.prototype,"control",void 0),f=e([d.Ih],f)},86824(a,b,c){c.d(b,{T:()=>e});var d=c(74395);function e(a,b){(0,d.visit)(a,{...b})}},58541(a,b,c){var d;(0,c(64463).N7)("#js-spoofed-commit-warning-trigger",{add(){let a=document.getElementById("spoof-warning");if(!a)return;let b=document.querySelector(".commit-title");b&&b.classList.add("pb-1"),a.hidden=!1,a.removeAttribute("aria-hidden")}})}},a=>{var b=b=>a(a.s=b);a.O(0,["vendors-node_modules_selector-observer_dist_index_esm_js","vendors-node_modules_manuelpuyol_turbo_dist_turbo_es2017-esm_js","vendors-node_modules_delegated-events_dist_index_js-node_modules_github_details-dialog-elemen-63debe","vendors-node_modules_morphdom_dist_morphdom-esm_js-node_modules_github_template-parts_lib_index_js","vendors-node_modules_github_clipboard-copy-element_dist_index_esm_js-node_modules_github_remo-8e6bec","vendors-node_modules_github_mini-throttle_dist_decorators_js-node_modules_scroll-anchoring_di-4942f3","app_assets_modules_github_ref-selector_ts","app_assets_modules_github_updatable-content_ts","app_assets_modules_github_sticky-scroll-into-view_ts","app_assets_modules_github_diffs_blob-lines_ts-app_assets_modules_github_diffs_linkable-line-n-dca161"],()=>b(70499));var c=a.O()}])
//# sourceMappingURL=diffs-2be0166470e3.js.map