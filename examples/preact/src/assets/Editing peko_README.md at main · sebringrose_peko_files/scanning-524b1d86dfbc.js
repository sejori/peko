"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["scanning"],{254(a,b,c){c.d(b,{ZG:()=>h,q6:()=>j,w4:()=>i});var d=c(8439);let e=!1,f=new d.Z;function g(a){let b=a.target;if(b instanceof HTMLElement&&b.nodeType!==Node.DOCUMENT_NODE)for(let c of f.matches(b))c.data.call(null,b)}function h(a,b){e||(e=!0,document.addEventListener("focus",g,!0)),f.add(a,b),document.activeElement instanceof HTMLElement&&document.activeElement.matches(a)&&b(document.activeElement)}function i(a,b,c){function d(b){let e=b.currentTarget;e&&(e.removeEventListener(a,c),e.removeEventListener("blur",d))}h(b,function(b){b.addEventListener(a,c),b.addEventListener("blur",d)})}function j(a,b){function c(a){let{currentTarget:d}=a;d&&(d.removeEventListener("input",b),d.removeEventListener("blur",c))}h(a,function(a){a.addEventListener("input",b),a.addEventListener("blur",c)})}},75662(a,b,c){c.d(b,{r:()=>d});function d(a,b){let c=a.createElement("template");return c.innerHTML=b,a.importNode(c.content,!0)}},35158(a,b,c){var d=c(59753);function e(a){let b=document.createElement("input");return b.setAttribute("type","hidden"),b.setAttribute("name",a.name),b.setAttribute("value",a.value),b}(0,d.on)("click",".js-file-toggle-show",({currentTarget:a})=>{let b=a.nextElementSibling;b&&b.classList.contains("js-file-toggle-hide")&&b.focus()}),(0,d.on)("click",".js-file-toggle-hide",({currentTarget:a})=>{let b=a.previousElementSibling;b&&b.classList.contains("js-file-toggle-show")&&b.focus()}),(0,d.on)("change",".js-scanning-alert-check",function({currentTarget:a}){let b=a.closest(".js-scanning-alert-list"),c=null!=b.querySelector(".js-scanning-alert-check:checked"),d=b.querySelector(".js-scanning-filter-options"),f=b.querySelector(".js-scanning-alert-bulk-actions"),g=b.querySelector(".js-scanning-alert-links");d&&(d.hidden=c),f&&(f.hidden=!c),g&&(g.hidden=c),function(a){let b=!1,c=a.querySelectorAll(".js-scanning-fixed-alert-numbers"),d=0!==c.length?JSON.parse(c[0].getAttribute("data-numbers")||"[]"):[];for(let f of a.querySelectorAll(".js-scanning-bulk-action-items")){f.innerHTML="";let g=a.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(let h of g)b||(b=-1!==d.indexOf(parseInt(h.value))),f.appendChild(e(h))}for(let i of a.querySelectorAll(".js-scanning-reopen-button"))i.hidden=b;for(let j of a.querySelectorAll(".js-scanning-reopen-button-disabled"))j.hidden=!b}(b)}),(0,d.on)("details-menu-selected",".js-scanning-code-path-menu",function(a){let b=a.detail.relatedTarget.getAttribute("data-target-code-path");for(let c of document.querySelectorAll(".js-scanning-code-path"))c.hidden=b!==c.getAttribute("data-code-path")},{capture:!0})},49657(a,b,c){var d=c(59753);function e(){document.removeEventListener("turbo:load",e);let a=document.querySelector('[data-target="secret-scanning-filter.clearButton"]');if(null===a)return;let b=a?.hidden;if(b){let c=document.querySelectorAll(".js-change-open-close-state"),d=c[c.length-2];d?.focus();return}document.title=document.title.concat(" (filters applied)"),a.focus()}(0,d.on)("click",".js-change-open-close-state",function(){document.addEventListener("turbo:load",e)})},93928(a,b,c){function d(a){let b=a.split("\u200D"),c=0;for(let d of b){let e=Array.from(d.split(/[\ufe00-\ufe0f]/).join("")).length;c+=e}return c/b.length}function e(a,b,c,d=!0){let e=a.value.substring(0,a.selectionEnd||0),f=a.value.substring(a.selectionEnd||0);return h(a,(e=e.replace(b,c))+(f=f.replace(b,c)),e.length,d),c}function f(a,b,c){if(null===a.selectionStart||null===a.selectionEnd)return e(a,b,c);let d=a.value.substring(0,a.selectionStart),f=a.value.substring(a.selectionEnd);return h(a,d+c+f,d.length),c}function g(a,b,c={}){let d=a.selectionEnd||0,e=a.value.substring(0,d),f=a.value.substring(d),g=""===a.value||e.match(/\n$/)?"":"\n",h=c.appendNewline?"\n":"",i=g+b+h;a.value=e+i+f;let j=d+i.length;return a.selectionStart=j,a.selectionEnd=j,a.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1})),a.focus(),i}function h(a,b,c,d=!0){a.value=b,d&&(a.selectionStart=c,a.selectionEnd=c),a.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1}))}function i(a,b){let c=[...a],d=new TextEncoder,e=new Uint8Array(4);for(let f=0;f<c.length;f++){let g=c[f],{written:h,read:i}=d.encodeInto(g,e);if(!h||!i)return -1;let j=h-i;if(0!==j&&(f<b&&(b-=j),f>=b))break}return b}c.d(b,{Om:()=>g,lp:()=>e,rq:()=>d,t4:()=>f,yb:()=>i})},16560(a,b,c){c(35158);var d=c(59753),e=c(254),f=c(69567),g=c(46263),h=c(64463),i=c(75662),j=c(93928);function k(){return document.querySelector(".js-custom-secret-scanning-pattern-form")}(0,h.N7)(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;let a=document.querySelector(".js-post-processing-expression-count");a&&a.textContent&&(window.postProcessingExpressionCount=parseInt(a.textContent))}}),(0,d.on)("click",".js-add-secret-format-button",a=>{let b=a.currentTarget;if(b&&window.postProcessingExpressionCount<r()){let c=document.querySelectorAll(".js-additional-secret-format");if(!c)return;for(let d of c)if(d.classList.contains("has-removed-contents")){d.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===r()&&(b.hidden=!0);break}}}),(0,d.on)("click",".js-remove-secret-format-button",a=>{let b=document.querySelector(".js-add-secret-format-button");if(!b)return;let c=a.currentTarget;if(!c)return;let d=c.closest(".js-additional-secret-format");if(!d)return;d.classList.toggle("has-removed-contents",!0);let e=d.getElementsByClassName("js-post-processing-input")[0];e.value="";let f=Array.from(d.getElementsByClassName("js-post-processing-input-rule")),g=d.getElementsByClassName("errored")[0];for(let h of(g&&g.classList.toggle("errored",!1),f))document.getElementById(`${h.id}_hidden`)?.remove();document.getElementById(`${e.id}_hidden`)?.remove(),m(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<r()&&(b.hidden=!1)}),(0,h.N7)(".js-test-code",{async add(){let a=document.querySelector(".js-test-code"),b=a.clientHeight,d=await c.e("vendors-node_modules_codemirror_lib_codemirror_js").then(c.t.bind(c,4631,23));if(window.codeEditor=d.default.fromTextArea(a,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:a.value,lineSeparator:"\r\n",theme:"github-light"}),0!==b){let e=document.querySelector(".CodeMirror");e&&(e.style.height=`${b}px`,e.style.border="1px solid #e1e4e8",e.style.borderRadius="6px")}window.codeEditor.save();let f=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!f)return;let g=m;f.hasAttribute("data-source-is-readonly")&&(g=y),window.codeEditor.on("change",()=>{g(window.codeEditor.getValue())})}}),(0,e.q6)(".js-custom-secret-scanning-pattern-form *",async function(){window.codeEditor&&m(window.codeEditor.getValue())}),(0,d.on)("click",".js-repo-selector-dialog-summary-button.disabled",a=>{a.preventDefault()}),(0,d.on)("click",".js-save-and-dry-run-button, .js-custom-pattern-submit-button, .js-org-repo-selector-dialog-dry-run-button",a=>{var b,c;a.preventDefault();let e=(b=a,b.currentTarget);if(!e)return;c=e,c.textContent=c.getAttribute("data-disable-with")||"",c.disabled=!0;let f=k();f&&((e.className.includes("js-save-and-dry-run-button")||e.className.includes("js-org-repo-selector-dialog-dry-run-button"))&&l(f,"submit_type","save_and_dry_run"),(0,d.f)(f,"submit"))});let l=(a,b,c)=>{let d=document.createElement("input");d.type="hidden",d.name=b,d.id=`${b}_hidden`,d.value=c,a.appendChild(d),d.required=!0},m=(0,g.D)(function(a){let b=document.querySelector(".js-custom-pattern-submit-button"),c=document.querySelector(".js-save-and-dry-run-button"),d=document.querySelector(".js-repo-selector-dialog-summary-button"),e=document.querySelector(".js-update-pattern-info"),f=document.querySelector(".js-test-pattern-matches");if(f){if(0===a.length){let g=document.querySelector(".js-dry-run-status");if(!g)return;v(g)||b?.setAttribute("disabled","true"),c?.setAttribute("disabled","true"),d?.classList.add("disabled"),f.textContent=""}else{window.codeEditor.save();let h=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(h instanceof HTMLFormElement))return;let i=k();if(!i)return;for(let j of i.elements)if(j instanceof HTMLInputElement&&j.name&&("text"===j.type||"radio"===j.type&&j.checked)){let m=document.getElementById(`${j.name}_hidden`);null!==m&&m.remove(),l(h,j.name,j.value)}x(h,o(i,b,c,d,e),n(f))}}},300),n=a=>b=>{if(0===b.length)a.textContent=" - No matches";else if(1===b.length)a.textContent=" - 1 match";else{let c=[];for(let d of b)c.push(JSON.stringify(d));let e=new Set(c),f=[...e];a.textContent=` - ${f.length} matches`}},o=(a,b,c,d,e)=>f=>{if(q(a),f?.message){if(b?.setAttribute("disabled","true"),c?.setAttribute("disabled","true"),d?.classList.add("disabled"),e)e.hidden=!0;else if(f?.error_type==="START_DELIMITER"||f?.error_type==="END_DELIMITER"||f?.error_type==="MUST_MATCH"||f?.error_type==="MUST_NOT_MATCH"){let g=document.querySelector(".js-more-options.js-details-container");g&&(g.classList.add("open"),g.classList.add("Details--on"))}return p(a,f),!1}{let h=document.querySelector(".js-mode");if(!h)return!1;let i=document.querySelector(".js-dry-run-status");return!!i&&("cancelled"!==i.textContent?.toLowerCase()&&"skipped"!==i.textContent?.toLowerCase()&&("unpublished"===h.textContent?.toLowerCase()||"published"===h.textContent?.toLowerCase())||b?.removeAttribute("disabled"),d?.classList.remove("disabled"),c?.removeAttribute("disabled"),e&&(e.hidden=!1),!0)}};function p(a,b){if("MUST_MATCH"===b.error_type||"MUST_NOT_MATCH"===b.error_type){let c=0,d=a.getElementsByClassName("js-additional-secret-format");for(let e of d){if(c>(b.error_index||0))return;let f=e.getElementsByTagName("input"),g=[...f].filter(a=>a.checked),h=g&&g[0]?.value.toUpperCase(),i=h===b.error_type&&c===b.error_index,j=e.getElementsByTagName("input"),k=[...j].filter(a=>"text"===a.type);if(!k||0===k.length)continue;let l=k[0];if(""!==l.value){if(i){let m=l.id;l&&l.parentElement&&s(l.parentElement);let n=document.createElement("p"),o=`${m}_error_message`;n.classList.add("note","error","mt-5"),n.id=o,n.textContent=b.message,l?.setAttribute("aria-describedby",o),l?.insertAdjacentElement("afterend",n);return}h===b.error_type&&c++}}}else{let p=w[b.error_type],q=document.querySelector(`#${p}`);q&&q.parentElement&&s(q.parentElement);let r=document.createElement("p"),t=`${p}_error_message`;r.classList.add("note","error"),r.id=t,r.textContent=b.message,q?.setAttribute("aria-describedby",t),q?.insertAdjacentElement("afterend",r)}}function q(a){let b=document.querySelector(".js-error-banner");for(let c of(b.hidden=!0,a.getElementsByTagName("input")))if(c.parentElement?.classList.contains("errored")){t(c.parentElement);let d=c.getAttribute("aria-describedby");document.querySelector(`#${d}`)?.remove()}}function r(){let a=document.querySelector(".js-post-processing-expression-max-count");if(!a)return 5;let b=a.textContent;return b?parseInt(b):5}function s(a){a?.classList.add("form-group","errored","my-0")}function t(a){a?.classList.remove("form-group","errored","my-0")}function u(){if(!window.codeEditor)return;let a=window.codeEditor.posFromIndex(0),b=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(let c of window.codeEditor.findMarks(a,b))c.clear()}function v(a){return"queued"===a.textContent?.toLowerCase()||"inprogress"===a.textContent?.toLowerCase()}let w={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function x(a,b,c){let d;try{let e=await fetch(a.action,{method:a.method,body:new FormData(a),headers:{Accept:"application/json"}});e.ok&&(d=await e.json())}catch(f){}if(d&&b(d.error)){if(d.has_matches){let g=JSON.parse(d.matches);for(let h of(u(),c(g),g))z(window.codeEditor,h.start,h.end)}else c([]),u()}}let y=(0,g.D)(function(a){let b=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(b instanceof HTMLFormElement))return;let c=document.querySelector(".js-test-pattern-matches");if(c){if(0===a.length)c.textContent="";else{if(!window.codeEditor)return;window.codeEditor.save(),x(b,()=>!0,n(c))}}},300);function z(a,b,c){let d=a.getValue();if(b=(0,j.yb)(d,b),c=(0,j.yb)(d,c),-1===b|| -1===c)return;let e=a.posFromIndex(b),f=a.posFromIndex(c);a.markText(e,f,{className:"text-bold hx_keyword-hl rounded-2 d-inline-block"})}async function A(a){let b=a.currentTarget;a.preventDefault(),C(b,parseInt(b.remove_repo_id.value),!1)}async function B(a,b=!1){let c=document.getElementById("selected_repo_ids");if(!c)return;let d=JSON.parse(c.value),e=new Set(d);e.clear(),c.value=JSON.stringify(Array.from(e));let g=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!g)return;b?g.removeAttribute("disabled"):g.setAttribute("disabled","true");let h=new FormData(a);h.append("selected_repo_ids",c.value);let j=await fetch(a.action,{method:a.method,body:h,headers:{Accept:"text/fragment+html"}});if(j.status>=400){let k="An unknown error occurred.",l=document.querySelector("template.js-flash-template");l.after(new f.R(l,{className:"flash-error",message:k}))}else if(!b){let m=document.querySelector(".js-dry-run-selected-repos"),n=(0,i.r)(document,await j.text());m.replaceWith(n)}}async function C(a,b,c){let d=document.getElementById("selected_repo_ids");if(!d)return;let e=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!e)return;let g=JSON.parse(d.value),h=new Set(g);c?h.size<D()&&h.add(b):h.delete(b),d.value=JSON.stringify(Array.from(h)),h.size>0?e.removeAttribute("disabled"):e.setAttribute("disabled","true");let j=new FormData(a);j.append("selected_repo_ids",d.value);let k=await fetch(a.action,{method:a.method,body:j,headers:{Accept:"text/fragment+html"}});if(k.status>=400){let l="An unknown error occurred.",m=document.querySelector("template.js-flash-template");m.after(new f.R(m,{className:"flash-error",message:l}))}else{let n=document.querySelector(".js-dry-run-selected-repos"),o=(0,i.r)(document,await k.text());n.replaceWith(o)}}function D(){let a=document.querySelector(".js-dry-run-selected-repos-max-count");if(!a)return 10;let b=a.textContent;return b?parseInt(b):10}(0,d.on)("click",".js-remove-dry-run-repo-form",A),(0,d.on)("auto-complete-change",".js-dry-run-repo-autocomplete",function(a){let b=a.target;if(!b.value)return;if(b.value.includes("No repositories found.")){b.value="";return}let c=b.closest("form");C(c,parseInt(c.repo_id.value),!0),b.value=""}),(0,d.on)("click",".js-clear-selected-repositories-button",function(){let a=document.querySelector(".js-add-dry-run-repo-form");a&&B(a)}),(0,h.N7)('input[type="radio"][name="dry_run_repo_selection"]',a=>{let b=a,c=document.querySelector(".js-dry-run-repo-selection-component");c&&b&& !0===b.checked&&("all_repos"===b.value?c.hidden=!0:"selected_repos"===b.value&&(c.hidden=!1))}),(0,d.on)("click",'input[type="radio"][name="dry_run_repo_selection"]',function(a){let b=a.currentTarget,c=document.querySelector(".js-dry-run-repo-selection-component");if(c){if("all_repos"===b.value){c.hidden=!0;let d=c.querySelector("form");if(!d)return;B(d,!0)}else if("selected_repos"===b.value){c.hidden=!1;let e=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!e)return;let f=document.getElementById("selected_repo_ids");if(!f)return;c.children[1].childElementCount<=1?e.setAttribute("disabled","true"):e.removeAttribute("disabled")}}}),(0,e.w4)("keydown",".js-dry-run-repo-autocomplete-input",function(a){"Enter"===a.key&&a.preventDefault()}),c(49657)}},a=>{var b=b=>a(a.s=b);a.O(0,["vendors-node_modules_selector-observer_dist_index_esm_js","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_delegated-events_dist_in-3fcf56"],()=>b(16560));var c=a.O()}])
//# sourceMappingURL=scanning-1e42041d669b.js.map