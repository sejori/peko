"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_github_text-ex-3415a8"],{57260(a,b,c){c.d(b,{P:()=>Attachment});class Attachment{constructor(a,b){this.file=a,this.directory=b,this.state="pending",this.id=null,this.href=null,this.name=null,this.percent=0}static traverse(a,b){return d(a,b)}static from(a){let b=[];for(let c of a)if(c instanceof File)b.push(new Attachment(c));else if(c instanceof Attachment)b.push(c);else throw Error("Unexpected type");return b}get fullPath(){return this.directory?`${this.directory}/${this.file.name}`:this.file.name}isImage(){return["image/gif","image/png","image/jpg","image/jpeg","image/svg+xml"].indexOf(this.file.type)> -1}isVideo(){return["video/mp4","video/quicktime"].indexOf(this.file.type)> -1}saving(a){if("pending"!==this.state&&"saving"!==this.state)throw Error(`Unexpected transition from ${this.state} to saving`);this.state="saving",this.percent=a}saved(a){var b,c,d;if("pending"!==this.state&&"saving"!==this.state)throw Error(`Unexpected transition from ${this.state} to saved`);this.state="saved",this.id=null!==(b=null==a?void 0:a.id)&& void 0!==b?b:null,this.href=null!==(c=null==a?void 0:a.href)&& void 0!==c?c:null,this.name=null!==(d=null==a?void 0:a.name)&& void 0!==d?d:null}isPending(){return"pending"===this.state}isSaving(){return"saving"===this.state}isSaved(){return"saved"===this.state}}function d(a,b){return b&&i(a)?h("",j(a)):Promise.resolve(e(Array.from(a.files||[])).map(a=>new Attachment(a)))}function e(a){return Array.from(a).filter(a=>{var b;return!(b=a).name.startsWith(".")})}function f(a){return new Promise(function(b,c){a.file(b,c)})}function g(a){return new Promise(function(b,c){let d=[],e=a.createReader(),f=()=>{e.readEntries(a=>{a.length>0?(d.push(...a),f()):b(d)},c)};f()})}async function h(a,b){let c=[];for(let d of e(b))if(d.isDirectory)c.push(...await h(d.fullPath,await g(d)));else{let i=await f(d);c.push(new Attachment(i,a))}return c}function i(a){return a.items&&Array.from(a.items).some(a=>{let b=a.webkitGetAsEntry&&a.webkitGetAsEntry();return b&&b.isDirectory})}function j(a){return Array.from(a.items).map(a=>a.webkitGetAsEntry()).filter(a=>null!=a)}class FileAttachmentElement extends HTMLElement{connectedCallback(){this.addEventListener("dragenter",m),this.addEventListener("dragover",m),this.addEventListener("dragleave",n),this.addEventListener("drop",o),this.addEventListener("paste",q),this.addEventListener("change",r)}disconnectedCallback(){this.removeEventListener("dragenter",m),this.removeEventListener("dragover",m),this.removeEventListener("dragleave",n),this.removeEventListener("drop",o),this.removeEventListener("paste",q),this.removeEventListener("change",r)}get directory(){return this.hasAttribute("directory")}set directory(a){a?this.setAttribute("directory",""):this.removeAttribute("directory")}async attach(a){let b=a instanceof DataTransfer?await Attachment.traverse(a,this.directory):Attachment.from(a),c=this.dispatchEvent(new CustomEvent("file-attachment-accept",{bubbles:!0,cancelable:!0,detail:{attachments:b}}));c&&b.length&&this.dispatchEvent(new CustomEvent("file-attachment-accepted",{bubbles:!0,detail:{attachments:b}}))}}function k(a){return Array.from(a.types).indexOf("Files")>=0}let l=null;function m(a){let b=a.currentTarget;l&&clearTimeout(l),l=window.setTimeout(()=>b.removeAttribute("hover"),200);let c=a.dataTransfer;c&&k(c)&&(c.dropEffect="copy",b.setAttribute("hover",""),a.preventDefault())}function n(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none");let b=a.currentTarget;b.removeAttribute("hover"),a.stopPropagation(),a.preventDefault()}function o(a){let b=a.currentTarget;if(!(b instanceof FileAttachmentElement))return;b.removeAttribute("hover");let c=a.dataTransfer;c&&k(c)&&(b.attach(c),a.stopPropagation(),a.preventDefault())}let p=/^image\/(gif|png|jpeg)$/;function q(a){if(!a.clipboardData||!a.clipboardData.items)return;let b=a.currentTarget;if(!(b instanceof FileAttachmentElement))return;let c=function(a){for(let b of a)if("file"===b.kind&&p.test(b.type))return b.getAsFile();return null}(a.clipboardData.items);if(!c)return;let d=[c];b.attach(d),a.preventDefault()}function r(a){let b=a.currentTarget;if(!(b instanceof FileAttachmentElement))return;let c=a.target;if(!(c instanceof HTMLInputElement))return;let d=b.getAttribute("input");if(d&&c.id!==d)return;let e=c.files;e&&0!==e.length&&(b.attach(e),c.value="")}window.customElements.get("file-attachment")||(window.FileAttachmentElement=FileAttachmentElement,window.customElements.define("file-attachment",FileAttachmentElement))},57852(a,b,c){var d=c(10160);let e=/\s|\(|\[/;function f(a,b,c,{multiWord:d,lookBackIndex:f,lastMatchPosition:g}={multiWord:!1,lookBackIndex:0,lastMatchPosition:null}){let h=a.lastIndexOf(b,c-1);if(-1===h||h<f)return;if(d){if(null!=g){if(g===h)return;h=g-b.length}let i=a[h+1];if(" "===i&&c>=h+b.length+1)return;let j=a.lastIndexOf("\n",c-1);if(j>h)return;let k=a.lastIndexOf(".",c-1);if(k>h)return}else{let l=a.lastIndexOf(" ",c-1);if(l>h)return}let m=a[h-1];if(m&&!e.test(m))return;let n=a.substring(h+b.length,c);return{text:n,position:h+b.length}}let g=["position:absolute;","overflow:auto;","word-wrap:break-word;","top:0px;","left:-9999px;"],h=["box-sizing","font-family","font-size","font-style","font-variant","font-weight","height","letter-spacing","line-height","max-height","min-height","padding-bottom","padding-left","padding-right","padding-top","border-bottom","border-left","border-right","border-top","text-decoration","text-indent","text-transform","width","word-spacing"],i=new WeakMap,j=new WeakMap;class TextExpander{constructor(a,b){this.expander=a,this.input=b,this.combobox=null,this.menu=null,this.match=null,this.justPasted=!1,this.lookBackIndex=0,this.oninput=this.onInput.bind(this),this.onpaste=this.onPaste.bind(this),this.onkeydown=this.onKeydown.bind(this),this.oncommit=this.onCommit.bind(this),this.onmousedown=this.onMousedown.bind(this),this.onblur=this.onBlur.bind(this),this.interactingWithList=!1,b.addEventListener("paste",this.onpaste),b.addEventListener("input",this.oninput),b.addEventListener("keydown",this.onkeydown),b.addEventListener("blur",this.onblur)}destroy(){this.input.removeEventListener("paste",this.onpaste),this.input.removeEventListener("input",this.oninput),this.input.removeEventListener("keydown",this.onkeydown),this.input.removeEventListener("blur",this.onblur)}dismissMenu(){this.deactivate()&&(this.lookBackIndex=this.input.selectionEnd||this.lookBackIndex)}activate(a,b){var c,e;if(this.input!==document.activeElement&&this.input!==(null===(e=null===(c=document.activeElement)|| void 0===c?void 0:c.shadowRoot)|| void 0===e?void 0:e.activeElement))return;this.deactivate(),this.menu=b,b.id||(b.id=`text-expander-${Math.floor(1e5*Math.random()).toString()}`),this.expander.append(b),this.combobox=new d.Z(this.input,b);let{top:f,left:j}=function(a,b=a.selectionEnd){let{mirror:c,marker:d}=function(a,b){let c=a.nodeName.toLowerCase();if("textarea"!==c&&"input"!==c)throw Error("expected textField to a textarea or input");let d=i.get(a);if(d&&d.parentElement===a.parentElement)d.innerHTML="";else{d=document.createElement("div"),i.set(a,d);let e=window.getComputedStyle(a),f=g.slice(0);"textarea"===c?f.push("white-space:pre-wrap;"):f.push("white-space:nowrap;");for(let j=0,k=h.length;j<k;j++){let l=h[j];f.push(`${l}:${e.getPropertyValue(l)};`)}d.style.cssText=f.join(" ")}let m=document.createElement("span");m.style.cssText="position: absolute;",m.innerHTML="&nbsp;";let n,o;if("number"==typeof b){let p=a.value.substring(0,b);p&&(n=document.createTextNode(p)),(p=a.value.substring(b))&&(o=document.createTextNode(p))}else{let q=a.value;q&&(n=document.createTextNode(q))}if(n&&d.appendChild(n),d.appendChild(m),o&&d.appendChild(o),!d.parentElement){if(!a.parentElement)throw Error("textField must have a parentElement to mirror");a.parentElement.insertBefore(d,a)}return d.scrollTop=a.scrollTop,d.scrollLeft=a.scrollLeft,{mirror:d,marker:m}}(a,b),e=c.getBoundingClientRect(),f=d.getBoundingClientRect();return setTimeout(()=>{c.remove()},5e3),{top:f.top-e.top,left:f.left-e.left}}(this.input,a.position);b.style.top=`${f}px`,b.style.left=`${j}px`,this.combobox.start(),b.addEventListener("combobox-commit",this.oncommit),b.addEventListener("mousedown",this.onmousedown),this.combobox.navigate(1)}deactivate(){let a=this.menu;return!!a&&!!this.combobox&&(this.menu=null,a.removeEventListener("combobox-commit",this.oncommit),a.removeEventListener("mousedown",this.onmousedown),this.combobox.destroy(),this.combobox=null,a.remove(),!0)}onCommit({target:a}){let b=a;if(!(b instanceof HTMLElement)||!this.combobox)return;let c=this.match;if(!c)return;let d=this.input.value.substring(0,c.position-c.key.length),e=this.input.value.substring(c.position+c.text.length),f={item:b,key:c.key,value:null},g=!this.expander.dispatchEvent(new CustomEvent("text-expander-value",{cancelable:!0,detail:f}));if(g||!f.value)return;let h=`${f.value} `;this.input.value=d+h+e;let i=d.length+h.length;this.deactivate(),this.input.focus({preventScroll:!0}),this.input.selectionStart=i,this.input.selectionEnd=i,this.lookBackIndex=i,this.match=null}onBlur(){if(this.interactingWithList){this.interactingWithList=!1;return}this.deactivate()}onPaste(){this.justPasted=!0}async onInput(){if(this.justPasted){this.justPasted=!1;return}let a=this.findMatch();if(a){this.match=a;let b=await this.notifyProviders(a);if(!this.match)return;b?this.activate(a,b):this.deactivate()}else this.match=null,this.deactivate()}findMatch(){let a=this.input.selectionEnd||0,b=this.input.value;for(let{key:c,multiWord:d}of(a<=this.lookBackIndex&&(this.lookBackIndex=a-1),this.expander.keys)){let e=f(b,c,a,{multiWord:d,lookBackIndex:this.lookBackIndex,lastMatchPosition:this.match?this.match.position:null});if(e)return{text:e.text,key:c,position:e.position}}}async notifyProviders(a){let b=[],c=!this.expander.dispatchEvent(new CustomEvent("text-expander-change",{cancelable:!0,detail:{provide:a=>b.push(a),text:a.text,key:a.key}}));if(c)return;let d=await Promise.all(b),e=d.filter(a=>a.matched).map(a=>a.fragment);return e[0]}onMousedown(){this.interactingWithList=!0}onKeydown(a){"Escape"===a.key&&(this.match=null,this.deactivate()&&(this.lookBackIndex=this.input.selectionEnd||this.lookBackIndex,a.stopImmediatePropagation(),a.preventDefault()))}}class TextExpanderElement extends HTMLElement{get keys(){let a=this.getAttribute("keys"),b=a?a.split(" "):[],c=this.getAttribute("multiword"),d=c?c.split(" "):[],e=0===d.length&&this.hasAttribute("multiword");return b.map(a=>({key:a,multiWord:e||d.includes(a)}))}connectedCallback(){let a=this.querySelector('input[type="text"], textarea');if(!(a instanceof HTMLInputElement||a instanceof HTMLTextAreaElement))return;let b=new TextExpander(this,a);j.set(this,b)}disconnectedCallback(){let a=j.get(this);a&&(a.destroy(),j.delete(this))}dismiss(){let a=j.get(this);a&&a.dismissMenu()}}window.customElements.get("text-expander")||(window.TextExpanderElement=TextExpanderElement,window.customElements.define("text-expander",TextExpanderElement))}}])
//# sourceMappingURL=vendors-node_modules_github_file-attachment-element_dist_index_js-node_modules_github_text-ex-3415a8-7459079baae2.js.map