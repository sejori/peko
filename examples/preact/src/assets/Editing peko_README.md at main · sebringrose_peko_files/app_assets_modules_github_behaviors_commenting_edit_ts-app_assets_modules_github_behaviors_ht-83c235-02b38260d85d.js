"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235"],{66602(a,b,c){c.d(b,{z:()=>p});var d=c(59753),e=c(19146),f=c(98249),g=c(76932),h=c(64611),i=c(64463),j=c(65935),k=c(22971);let l=[];function m(a){a.querySelector(".js-write-tab").click();let b=a.querySelector(".js-comment-field");b.focus(),(0,d.f)(b,"change")}function n(a){return a.querySelector(".js-comment-edit-form-deferred-include-fragment")}function o(a){n(a)?.setAttribute("loading","eager")}function p(a){let b=a.currentTarget.closest("form"),c=a.currentTarget.getAttribute("data-confirm-text");if((0,h.T)(b)&&!confirm(c))return!1;for(let d of b.querySelectorAll("input, textarea")){let e=d;e.value=e.defaultValue,e.classList.contains("session-resumable-canceled")&&(e.classList.add("js-session-resumable"),e.classList.remove("session-resumable-canceled"))}let f=a.currentTarget.closest(".js-comment");return f&&f.classList.remove("is-comment-editing"),!0}function q(a){let b=a.querySelector("ol");if(b){b.innerHTML="";let c=l.map(a=>{let b=document.createElement("li");return b.textContent=a,b});for(let d of c)b.appendChild(d)}a.hidden=!1}function r(a,b){let c=a.querySelector(".js-comment-show-on-error");c&&(c.hidden=!b);let d=a.querySelector(".js-comment-hide-on-error");d&&(d.hidden=b)}(0,i.N7)(".js-comment-header-actions-deferred-include-fragment",{subscribe:a=>(0,g.RB)(a,"loadstart",()=>{let b=a.closest(".js-comment");o(b)},{capture:!1,once:!0})}),(0,i.N7)(".js-comment .contains-task-list",{add(a){let b=a.closest(".js-comment");o(b)}}),(0,d.on)("click",".js-comment-edit-button",function(a){let b=a.currentTarget.closest(".js-comment");b.classList.add("is-comment-editing");let c=n(b);c?c.addEventListener("include-fragment-replaced",()=>m(b),{once:!0}):m(b);let d=a.currentTarget.closest(".js-dropdown-details");d&&d.removeAttribute("open")}),(0,d.on)("click",".js-comment-hide-button",function(a){let b=a.currentTarget.closest(".js-comment");r(b,!1);let c=b.querySelector(".js-minimize-comment");c&&c.classList.remove("d-none");let d=a.currentTarget.closest(".js-dropdown-details");d&&d.removeAttribute("open")}),(0,d.on)("click",".js-comment-hide-minimize-form",function(a){let b=a.currentTarget.closest(".js-minimize-comment");b.classList.add("d-none")}),(0,d.on)("click",".js-comment-cancel-button",p),(0,d.on)("click",".js-cancel-issue-edit",function(a){let b=a.currentTarget.closest(".js-details-container");b.querySelector(".js-comment-form-error").hidden=!0}),(0,j.AC)(".js-comment-delete, .js-comment .js-comment-update, .js-issue-update, .js-comment-minimize, .js-comment-unminimize",function(a,b,c){let d=a.closest(".js-comment");d.classList.add("is-comment-loading");let e=d.getAttribute("data-body-version");e&&c.headers.set("X-Body-Version",e)}),(0,j.AC)(".js-comment .js-comment-update",async function(a,b){let c,d=a.closest(".js-comment"),e=d.querySelector(".js-comment-update-error"),g=d.querySelector(".js-comment-body-error");e instanceof HTMLElement&&(e.hidden=!0),g instanceof HTMLElement&&(g.hidden=!0),l=[];try{c=await b.json()}catch(h){if(422===h.response.status){let i=JSON.parse(h.response.text);if(i.errors){e instanceof HTMLElement&&(e.textContent=`There was an error posting your comment: ${i.errors.join(", ")}`,e.hidden=!1);return}}else throw h}if(!c)return;let j=c.json;j.errors&&j.errors.length>0&&(l=j.errors,q(g));let k=d.querySelector(".js-comment-body");if(k&&j.body&&(k.innerHTML=j.body),null!=j.source){if(j.default_merge_commit_message){if(document.querySelector(".js-merge-pr.is-merging")){let m=document.querySelector(".js-merge-pull-request textarea");m instanceof HTMLTextAreaElement&&m.value===m.defaultValue&&(m.value=m.defaultValue=j.default_merge_commit_message)}if(j.default_squash_commit_message&&document.querySelector(".js-merge-pr.is-squashing")){let n=document.querySelector(".js-merge-pull-request textarea");n instanceof HTMLTextAreaElement&&n.value===n.defaultValue&&(n.value=n.defaultValue=j.default_squash_commit_message)}}document.querySelector(".js-merge-box-button-merge")?.setAttribute("data-input-message-value",j.default_merge_commit_message),document.querySelector(".js-merge-box-button-squash")?.setAttribute("data-input-message-value",j.default_squash_commit_message)}d.setAttribute("data-body-version",j.newBodyVersion);let o=d.querySelector(".js-body-version");o instanceof HTMLInputElement&&(o.value=j.newBodyVersion);let p=d.querySelector(".js-discussion-poll");for(let r of(p&&j.poll&&(p.innerHTML=j.poll),d.querySelectorAll("input, textarea"))){let s=r;s.defaultValue=s.value}d.classList.remove("is-comment-stale","is-comment-editing");let t=d.querySelector(".js-comment-edit-history");if(t){let u=await (0,f.a)(document,j.editUrl);t.innerHTML="",t.append(u)}}),(0,i.N7)(".js-comment-body-error",{add(a){l&&l.length>0&&q(a)}}),(0,j.AC)(".js-comment .js-comment-delete, .js-comment .js-comment-update, .js-comment-minimize, .js-comment-unminimize",async function(a,b){let c=a.closest(".js-comment");try{await b.text()}catch(d){if(422===d.response.status){let e;try{e=JSON.parse(d.response.text)}catch(f){}e&&e.stale&&c.classList.add("is-comment-stale")}else throw d}c.classList.remove("is-comment-loading")}),(0,j.AC)(".js-timeline-comment-unminimize, .js-timeline-comment-minimize",async function(a,b){let c=a.closest(".js-minimize-container");try{let d=await b.html();c.replaceWith(d.html)}catch(e){r(c,!0)}}),(0,j.AC)(".js-discussion-comment-unminimize, .js-discussion-comment-minimize",async function(a,b){let c=a.closest(".js-discussion-comment"),d=c.querySelector(".js-discussion-comment-error");d&&(d.hidden=!0);try{let e=await b.html();c.replaceWith(e.html)}catch(f){if(f.response.status>=400&&f.response.status<500){if(f.response.html){let g=f.response.html.querySelector(".js-discussion-comment").getAttribute("data-error");d instanceof HTMLElement&&(d.textContent=g,d.hidden=!1)}}else throw f}}),(0,j.AC)(".js-comment-delete",async function(a,b){await b.json();let c=a.closest(".js-comment-delete-container");!c&&(c=a.closest(".js-comment-container")||a.closest(".js-line-comments"))&&1!==c.querySelectorAll(".js-comment").length&&(c=a.closest(".js-comment"));let d=c?.closest(".js-comment-container")||c?.closest(".js-line-comments");if(c?.remove(),d&&1===d.querySelectorAll(".js-comment").length)for(let e of d.querySelectorAll(".js-delete-on-last-reply-deleted"))e.remove()}),(0,j.AC)(".js-issue-update",async function(a,b){let c=a.closest(".js-details-container"),d=c.querySelector(".js-comment-form-error"),e;try{e=await b.json()}catch(f){d.textContent=f.response?.json?.errors?.[0]||"Something went wrong. Please try again.",d.hidden=!1}if(!e)return;c.classList.remove("open"),d.hidden=!0;let g=e.json;if(null!=g.issue_title){c.querySelector(".js-issue-title").textContent=g.issue_title;let h=c.closest(".js-issues-results");if(h){if(h.querySelector(".js-merge-pr.is-merging")){let i=h.querySelector(".js-merge-pull-request .js-merge-title");i instanceof HTMLInputElement&&i.value===i.defaultValue&&(i.value=i.defaultValue=g.default_merge_commit_title)}else if(h.querySelector(".js-merge-pr.is-squashing")){let j=h.querySelector(".js-merge-pull-request .js-merge-title");j instanceof HTMLInputElement&&j.value===j.defaultValue&&(j.value=j.defaultValue=g.default_squash_commit_title)}let k=h.querySelector("button[value=merge]");k&&k.setAttribute("data-input-title-value",g.default_merge_commit_title);let l=h.querySelector("button[value=squash]");l&&l.setAttribute("data-input-title-value",g.default_squash_commit_title)}}for(let m of(document.title=g.page_title,a.elements))(m instanceof HTMLInputElement||m instanceof HTMLTextAreaElement)&&(m.defaultValue=m.value)}),(0,j.AC)(".js-comment-minimize",async function(a,b){await b.json();let c=a.closest(".js-comment"),d=c.querySelector(".js-minimize-comment");if(d&&d.classList.contains("js-update-minimized-content")){let e=a.querySelector("input[type=submit], button[type=submit]");e&&e.classList.add("disabled");let f=c.closest(".js-comment-container");f&&await (0,k.x0)(f)}else{d&&d.classList.add("d-none");let g=a.closest(".unminimized-comment");g.classList.add("d-none"),g.classList.remove("js-comment");let h=a.closest(".js-minimizable-comment-group"),i=h.querySelector(".minimized-comment");i&&i.classList.remove("d-none"),i&&i.classList.add("js-comment")}}),(0,j.AC)(".js-comment-unminimize",async function(a,b){await b.json();let c=a.closest(".js-minimizable-comment-group"),d=c.querySelector(".unminimized-comment"),e=c.querySelector(".minimized-comment");if(d)d.classList.remove("d-none"),d.classList.add("js-comment"),e&&e.classList.add("d-none"),e&&e.classList.remove("js-comment");else{if(e){let f=e.querySelector(".timeline-comment-actions");f&&f.classList.add("d-none"),e.classList.remove("js-comment")}let g=c.closest(".js-comment-container");await (0,k.x0)(g)}}),(0,d.on)("details-menu-select",".js-comment-edit-history-menu",a=>{let b=a.detail.relatedTarget.getAttribute("data-edit-history-url");if(!b)return;a.preventDefault();let c=(0,f.a)(document,b);(0,e.W)({content:c,dialogClass:"Box-overlay--wide overflow-visible",errorMessage:"Couldn't display edit history diff"})},{capture:!0})},81775(a,b,c){c.d(b,{G:()=>i});var d=c(254),e=c(64463),f=c(59753);function g(a){let b=a.getAttribute("data-required-value"),c=a.getAttribute("data-required-value-prefix");if(a.value===b)a.setCustomValidity("");else{let d=b;c&&(d=c+d),a.setCustomValidity(d)}}(0,d.q6)("[data-required-value]",function(a){let b=a.currentTarget;g(b)}),(0,f.on)("change","[data-required-value]",function(a){let b=a.currentTarget;g(b),i(b.form)}),(0,d.q6)("[data-required-trimmed]",function(a){let b=a.currentTarget;""===b.value.trim()?b.setCustomValidity(b.getAttribute("data-required-trimmed")):b.setCustomValidity("")}),(0,f.on)("change","[data-required-trimmed]",function(a){let b=a.currentTarget;""===b.value.trim()?b.setCustomValidity(b.getAttribute("data-required-trimmed")):b.setCustomValidity(""),i(b.form)}),(0,d.ZG)("input[pattern],input[required],textarea[required],input[data-required-change],textarea[data-required-change],input[data-required-value],textarea[data-required-value]",a=>{let b=a.checkValidity();function c(){let c=a.checkValidity();c!==b&&a.form&&i(a.form),b=c}a.addEventListener("input",c),a.addEventListener("blur",function b(){a.removeEventListener("input",c),a.removeEventListener("blur",b)})});let h=new WeakMap;function i(a){let b=a.checkValidity();for(let c of a.querySelectorAll("button[data-disable-invalid]"))c.disabled=!b}(0,e.N7)("button[data-disable-invalid]",{constructor:HTMLButtonElement,initialize(a){let b=a.form;if(b){var c;c=b,h.get(c)||(c.addEventListener("change",()=>i(c)),h.set(c,!0)),a.disabled=!b.checkValidity()}}}),(0,e.N7)("input[data-required-change], textarea[data-required-change]",function(a){let b=a,c="radio"===b.type&&b.form?b.form.elements.namedItem(b.name).value:null;function d(a){let d=b.form;if(a&&"radio"===b.type&&d&&c)for(let e of d.elements.namedItem(b.name))e instanceof HTMLInputElement&&e.setCustomValidity(b.value===c?"unchanged":"");else b.setCustomValidity(b.value===(c||b.defaultValue)?"unchanged":"")}b.addEventListener("input",d),b.addEventListener("change",d),d(),b.form&&i(b.form)}),document.addEventListener("reset",function(a){if(a.target instanceof HTMLFormElement){let b=a.target;setTimeout(()=>i(b))}})}}])
//# sourceMappingURL=app_assets_modules_github_behaviors_commenting_edit_ts-app_assets_modules_github_behaviors_ht-83c235-388852731025.js.map